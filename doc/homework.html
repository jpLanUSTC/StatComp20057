<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jianping Lan" />

<meta name="date" content="2020-12-19" />

<title>Answers of StatComp course</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Answers of StatComp course</h1>
<h4 class="author">Jianping Lan</h4>
<h4 class="date">2020-12-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp20057</strong> also provides the answers of homework for the ‘Statistical Computing’ course.</p>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>give an example contain texts and at least one figure</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Plot the sepal length(x) of iris</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">x =<span class="st"> </span>iris[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">plot</span>(x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Sepal.Length&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>give an example contains texts and at least one table</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Capture the first five data of Sepal.Length and Sepal.Width in iris to make a table</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">x =<span class="st"> </span>iris[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-2" title="2">y =<span class="st"> </span>iris[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb2-3" title="3">x1 =<span class="st"> </span>x[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb2-4" title="4">y1 =<span class="st"> </span>y[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb2-5" title="5">t &lt;-<span class="st"> </span><span class="kw">cbind</span>(x1,y1)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">xtabs</span>(<span class="dt">data =</span> t)</a></code></pre></div>
<pre><code>##      y1
## x1    3 3.1 3.2 3.5 3.6
##   4.6 0   1   0   0   0
##   4.7 0   0   1   0   0
##   4.9 1   0   0   0   0
##   5   0   0   0   0   1
##   5.1 0   0   0   1   0</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>give an example contain at least a couple of LaTeX formulas</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\sqrt{n}(\sqrt{F_{n}(x)}-\sqrt{F(x)}) \rightarrow N(0,\frac{F(x)[1-F(x)]}{4F(x)})=N(0,\frac{1-F(x)}{4})\)</span></p>
<p><span class="math inline">\(\sqrt{F_{n}(x)} \rightarrow N(\sqrt{F(x)},\frac{1-F(x)}{4n})\)</span></p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.9, 3.10, and 3.13 (pages 94-95, Statistical Computating with R).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="q1" class="section level3">
<h3>Q1</h3>
<p>The Pareto(a, b) distribution has cdf <span class="math inline">\(F(x) = 1 −(b/x)^a, x ≥ b &gt; 0,a &gt; 0.\)</span> Derive the probability inverse transformation F−1(U) and use the inverse transform method to simulate a random sample from the Pareto(2, 2) dis- tribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb4-4" title="4">x &lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u) <span class="co">#F(x)=1-(2/x)^2, x&gt;=2&gt;0</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb4-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">100</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="q2" class="section level3">
<h3>Q2</h3>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math inline">\(f_{e}(x) =3/4(1 − x^2), |x| ≤ 1\)</span> Devroye and Györfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid U1,U2,U3∼ Uniform(−1,1). If |U3| ≥ |U2| and |U3| ≥ |U1|, deliver U2; otherwise deliver U3. Write a function to generate random variates from f_{e}, and construct the histogram density estimate of a large simulated random sample.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb5-3" title="3">j &lt;-<span class="st"> </span>k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-4" title="4">u &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {</a>
<a class="sourceLine" id="cb5-6" title="6">  u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>); u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-7" title="7">  j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-8" title="8">  u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">1</span>) <span class="co"># random variate from g(.)</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="cf">if</span> (<span class="kw">abs</span>(u3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u2) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u1)){</a>
<a class="sourceLine" id="cb5-10" title="10">    <span class="co">#we accept u2</span></a>
<a class="sourceLine" id="cb5-11" title="11">    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-12" title="12">    u[k] &lt;-<span class="st"> </span>u2</a>
<a class="sourceLine" id="cb5-13" title="13">  }</a>
<a class="sourceLine" id="cb5-14" title="14">  <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb5-15" title="15">    <span class="co">#we accept u3</span></a>
<a class="sourceLine" id="cb5-16" title="16">    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-17" title="17">    u[k] &lt;-<span class="st"> </span>u3</a>
<a class="sourceLine" id="cb5-18" title="18">  }</a>
<a class="sourceLine" id="cb5-19" title="19">}</a>
<a class="sourceLine" id="cb5-20" title="20"></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="kw">hist</span>(u,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb5-22" title="22">t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb5-23" title="23"><span class="kw">lines</span>(t, <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>t<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAACsAAFUAKysAK1UAK4AAVaorAAArACsrAFUrKwArKysrK1UrVaorgNRVAABVACtVKwBVKytVK1VVVVVVgKpVqqpVqv+AKwCAKyuAVSuAgFWAgKqAqv+A1P+qVQCqgFWqgICq1Kqq1P+q///T09PUgCvUqoDU1IDU////qlX/qoD/1ID/1Kr//6r//9T////0MPSIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKWElEQVR4nO2dCXejNhSFlbZJpls87bRNug3dQhvq2vn/v66AEAiMuFpBOPeeMzMeLJ6ePmuXEOKVWpTY2oHcRUBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAR01YCO90I8BtrIHlCAg6fD42t183Gz+NdRgIPV7cvr+SkwC10zoEZNLtoyfmudf/+1//zv9y/W9835p9tCKm9fXKKzcyCB/vvwp/a/44e/bG+c8W9sa1nlJ385RWflQEydvmnbkdO346ry+LnJ5fNPQtxoP/ngX9U1SIMtXHxKWUWbo8NKDKiok/uxrikfJtfrnD8bvgFa666/0PtXN9ktjsFWHRYAavPPUnQWSgvo/NS6WF60tcf7KTKpUnz98vrfN3343r3zU9el6W39DTs5x3fKjCk6C6UG1Px0p8PFD9iRmw9fY1Ip790rb35uLypb5x/FZz8DQEWbGx/N0dkoKaBKFpdKFhn5TyFTVSwk7p9DnxzlXl0ByTqos/V6ev/9SzVvYxRPp6XolrUGoELIDN54qRJYavXMWKUQt30z1bl3Otx1lbSyJc3Pp1qPpzdqig5phSJWVx9d+3P45A+VOSphqjeLL0X/nfKuqO9qcfS2pI15QHo8fVDfanoFQKeDSkgpvlAfKyFTIOuJUcOl/d5C/f+xwzHYejUD0uPpg/pWQqsCqn9/xWHR475Old7JNsgBkBaPTXSLWhVQ/Un5uexxMQJUqlx283Ee0DQbavH0QTMGNNQbhfhOpUFVCuO0dY34qatB+hLWA7Kqg/R4+qAZ10F9y1O1LZpMlKFZKdqO4lN3w8g5+1ZMj6dT1q2YanLbfHG8lz9lOZ+4unA06n7uGUB6820ANIqnkyE6C63Yk5Y/atlmAWPXdjRYnQGk98oNgPR4ej/y7Ekr2Y/FRpr17dKWhbIdi3U6P01rAKvh9axvl7YslO1oXuliPugrmxw/79vUloXsonNxIrrOP+qpcpkTRLYsFBTdanPSv2lz0r+ETBKPbVkoLLrsVzW2FgEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAbkBKoS4azbDBW/w34+cADWrJ0WztHk6eK8z7U0ugNoNpvLhh4CFpp3JBVC7L7lqF3Er76XcvYk5CMivDrrcGX61YisGxH4QEAEBeQIq2Yq5WekVxVxOipyiJIA2pb8LQM9SOwDUNvG1jDXQGwfU7xythKGj+LYBaf1n01DjbQPSHqI1DVbfNqDVc5AYKX9Aw4b+NeqgoV3vctA2Db1blN2jFOZHZ6KkQEw1FLH1EeXYD1JIejB6HbR2NsoJ0EWOmQO0di7KCpCsaS7BTFuxNRFlBqjNPUZAw5BsPUQ5ANIacjELZvyv6G6K6rjZuQzMDTlkEcyz1tyvN7jPCJC5cp4A6nnG9d3gXAbmhMoYjoBWKWbZABIQzCWgNWbUcwG02HoZAa2QhzIBZNN6zQFKn4nyAGQYWhBQd5Nd8z4PKPWKShaA7MAYAA18I6ZDc257c7bNuxGQKqExEzJ4t7k5EZyDdgAooB4Q4UVMNYJRkjLjn9Tp4H2CzJw5u9Bg/scaUDtMSZ6DmnOMQvdFOQJy6v8sAXpeA9BrBEauOcgFzOVgVc+AqRY9plbLpYVld3MgtBOYC0CTyysAqtrNdd15oeHmcOiYgJLnoGZJR5IJ2OPr5KRjDxoCSrOsqz6cDqHH44/MWYXdF6D3kk/YFnEHH0X8IpaC0AWgsN2H9i62szmRAaUg1Jkshr7wSs18AkBJRvUXOSiSOauAkQF1fyUCtK65brKLgJbD7QfQ6fCgdraE9KNtAU12KcQEFH3IsUkOmpCJCih2d8jH2vHe+LCPJSCnFDsCSpaDmudQy4XNY8P+soWCaOXcdAJoJ4CK25fj/d1rsTBt1m1NDMxBF3OssQFFJaSNxR7b84cXhxrysOIwQJdzrPsB1BwlD4YaRT2kzR5QzA61VsTumvzRvOJjUaV48AZk2IQYG5D8GB1QXQU3h+rDmfvj/afegLpkJAcUsb/oYWb0ZgInc2Lo7l4zIH9zhl0KOwEEnwXTZarKcwH0HG3EoVXSIYsZdnMxKwKK1thrzXyMwxRQKxaQYtfg8QHFOE0Bt2K7BWT1OobAZ1Z3Dcj8KqFBgc+smnYpJAIUaeOK+mAxYRb4xKFxI1CqHBSFkIuRwGdWrx/Q3nJQFEKajbqQ3b4US4190DOr5q1kqeqgKKN6rZK++Vg2o/klQgHPrGoLhSsBUn+8uFymqCk/TcFJsfRsmObYF6CmBm4Apdi8IDqvVwfU/BU7BxVB59uZAIkIKd4YUFcH+b8McGJudHUzQM/Bo/pxK9a+HT6SOf3qdoCCO9SrTJiBNWYCugpAsosTegKpsRXbDFCsOqh7s20ZuNd+1hv0rMEeAFWqcl5Y83IwN7m4LaAwQvJubbZsaW3e1tz04sY5KIhQv4FKXYg51ABDjF0BgjM9Lub6/3Webl0HhRBKD0jESjEBvU1AwiEpqQCFEFKA4Oa6ZSvz03cq8+wfUDRlCiggmQTklKJg5QgobPI+MSARMcW+gBSnGCkK1rQnHTPFBPQGAUVNMQElBeQ7L0RATikKVs6A/JKaEpDzwYhpAfmlNSEg65OTCIiA5syZ9wMRkPqYGSCvxLrd47ANeGHD1PUCctkGnB8gv1F9kk2clss9KwNSf9IBst4GLDR/sgLU/JVFDhrceVOArLcB5wvo2XnHmVtwy23Avucf7x+QpTkCQoBiJGXfgJafWc0YkPOsR5wcNFlZFVlrC0BXLAICijxYvT5FHqxenyIPNTqjWSsdIOttVrZGLcNtEswnuH0Oihv5bgBZDFbdjF4dIDxYdTN6fYAiGyWgOOEIKMdgnsHjGiWgOOGuD9A1iYCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIKDag4+f9ckcVeJ7V6H6zMf0bOSVsOH3Ez7XIgE6Hfj2oOVCmCiA0ut9sbPTN8Z05Pk/X4gKqhlVpuUbkf5bM6H6zsfE3C8t1vq5FBVSJh95FeRCR/1kyo/vNxsbflMZEe7sWuw4avGhzu/9BF6P7zcbG3xRfCvNLGv1cSwZIlnH/Smh0v9nY6Bv56iHTeb1+rl0VoIkLUVy7riImLxmOYdu0iPXvYd+2kpaXDG19ZpX0Fs28TDksYts187oXm3QU20TDSnrDjmLnhTx1sAwcanT3I2OjYM0rmU0HQfq5xsEqEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAeUOqD2zSDu4aHUREBABAREQEAEBERBQ/oAegt/QHaTcAZ2fbl/OT8adq+mVO6D2IcIfWMTyFQEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAf0P+fXgsKZqDp4AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="q3" class="section level3">
<h3>Q3</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density fe(3.10).</p>
<p>Let <span class="math inline">\(T_{1} = |U_{1}|,T_{2} = |U_{2}|,T_{3} = |U_{3}|\)</span></p>
<p>Therefore, <span class="math inline">\(T_{1}, T_{2}, T_{3} \sim U(0,1)\)</span></p>
<p>Suppose <span class="math display">\[\begin{equation}
     Z = 
     \begin{cases}
     U_{2}, &amp; if \ T_{3} \geq max \{ T_{1}, T_{2} \};\\
     U_{3}, &amp; \text{otherwise}
     \end{cases}
\end{equation}\]</span> <span class="math display">\[\begin{equation}
     Y = 
     \begin{cases}
     T_{2}, &amp; if \ T_{3} \geq max \{ T_{1}, T_{2} \};\\
     T_{3}, &amp; \text{otherwise}
     \end{cases}
\end{equation}\]</span> The relationship between Z and Y is <span class="math inline">\(Y = |Z|\)</span></p>
<p>Then the c.d.f of <span class="math inline">\(Y\)</span> is <span class="math display">\[\begin{align}
F_{Y}(y) &amp;= P(Y \leq y), y \in (0,1)\\
         &amp;= P(T_{2} \leq y, T_{3} \geq max \{ T_{1}, T_{2} \}) + P(T_{3} \leq y, T_{3} \leq max \{ T_{1}, T_{2} \})
\end{align}\]</span> There are two cases of <span class="math inline">\(P(T_{2} \leq y, T_{3} \geq max \{ T_{1}, T_{2} \})\)</span>, <span class="math display">\[\begin{align}
P(T_{2} \leq y, T_{3} \geq max \{ T_{1}, T_{2} \}) &amp;= P(T_{2} \leq y, T_{2} \leq T_{1}, T_{1} \leq T_{3}) + P(T_{2} \leq y, T_{1} \leq T_{2}, T_{2} \leq T_{3})\\
&amp;= \int_{0}^{y}\int_{t_{2}}^{1}\int_{t_{1}}^{1} 1\ dt_{3}dt_{1}dt_{2} + 
   \int_{0}^{y}\int_{0}^{t_{2}}\int_{t_{2}}^{1} 1\ dt_{3}dt_{1}dt_{2}\\
&amp;= \frac{y}{2} - \frac{y^{3}}{6}
\end{align}\]</span> Similarly, the <span class="math inline">\(P(T_{3} \leq y, T_{3} \leq max \{ T_{1}, T_{2} \})\)</span> has six cases, <span class="math display">\[\begin{align}
P(T_{3} \leq y, T_{3} \leq max \{ T_{1}, T_{2} \}) &amp;= \int_{y}^{1}\int_{t_{1}}^{1}\int_{0}^{y} 1\ dt_{3}dt_{2}dt_{1} +
\int_{y}^{1}\int_{t_{2}}^{1}\int_{0}^{y} 1\ dt_{3}dt_{1}dt_{2} +\\
&amp;\int_{0}^{y}\int_{y}^{1}\int_{0}^{y} 1\ dt_{3}dt_{2}dt_{1} +
\int_{0}^{y}\int_{t_{1}}^{y}\int_{0}^{t_{2}} 1\ dt_{3}dt_{2}dt_{1} +\\
&amp;\int_{0}^{y}\int_{y}^{1}\int_{0}^{y} 1\ dt_{3}dt_{1}dt_{2} +
\int_{0}^{y}\int_{t_{2}}^{y}\int_{0}^{t_{1}} 1\ dt_{3}dt_{1}dt_{2}\\
&amp;= y - \frac{y^{3}}{3}
\end{align}\]</span> Above all <span class="math inline">\(F_{Y}(y) = \frac{3y}{2} - \frac{y^{3}}{2}\)</span>, hence<span class="math inline">\(f_{Y}(y) = \frac{3}{2} - \frac{3y^{2}}{2}, y \in (0, 1)\)</span></p>
<p>Note that the relationship betweenZ and Y, hence the p.d.f of Z is <span class="math inline">\(f_{Z}(z) = \frac{1}{2}f_{Y}(y), z \in (-1, 1)\)</span></p>
<p>Therefore,<span class="math inline">\(f_{Z}(z) = \frac{3}{4} - \frac{3}{4}z^{2}, z \in (-1, 1)\)</span></p>
</div>
<div id="q4" class="section level3">
<h3>Q4</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math inline">\(F(y) = 1 −(\beta/(\beta +y))^y, y ≥ 0.\)</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 a n d β = 2. Compare the empirical and theoretical (Pareto) distributions by graph- ing the density histogram of the sample and superimposing the Pareto density curve.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb6-3" title="3">r &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb6-4" title="4">beta &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-5" title="5">lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta)</a>
<a class="sourceLine" id="cb6-6" title="6">y &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda) <span class="co"># generate random observations from mixtrue with r = 4, beta = 2</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">hist</span>(y,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y) <span class="op">==</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">6</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb6-8" title="8">z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">lines</span>(z, <span class="dv">2</span><span class="op">^</span><span class="dv">6</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>z)<span class="op">^</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="exercise-5.1" class="section level2">
<h2>Exercise 5.1</h2>
Compute a Monte Carlo estimate of <span class="math display">\[\begin{align}
        \int_{0}^{\pi/3} sintdt\notag
    \end{align}\]</span>

<p>and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The exact value of the integral is <span class="math inline">\(\int_{0}^{\pi/3} sintdt = -cos(\pi/3) + cos(0) = 1/2\)</span>. Suppose the exact value of integral is <span class="math inline">\(\theta\)</span>, and the Monte Carlo estimate is <span class="math inline">\(\hat{\theta}\)</span>. Then we generate 1000 samples from the uniform distribution <span class="math inline">\(U(0, \pi/3)\)</span> and use the <span class="math inline">\(\frac{1}{n}\sum\limits_{i = 1}^{n}\frac{\pi}{3}sin(x_{i})\)</span> to obtain the Monte Carlo estimate <span class="math inline">\(\hat{\theta}\)</span>. And compare the <span class="math inline">\(\hat{\theta}\)</span> with the <span class="math inline">\(\theta\)</span> at the last line, from this result, the <span class="math inline">\(\hat{\theta}\)</span> is very close to the <span class="math inline">\(\theta\)</span>. The process is as follows.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11111</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb7-3" title="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 0.4990158 0.5000000</code></pre>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antitetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>In exercise 5.6, when <span class="math inline">\(U ∼ (0,1)\)</span>, the <span class="math inline">\(Cov(e^{U} , e^{1 - U}) = e - (e - 1)^{2}\)</span> and <span class="math inline">\(Var(e^{U} + e^{1 - U}) = Var(e^{U}) + Var(e^{1 - U}) + 2Cov(e^{U} , e^{1 - U}) = 3e^{2} - 6e + 1\)</span>, using antithetic variates in following result, we obtain the theoretical percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> is 0.8585377</p>
<p>The procedure is shown as follow, and the answer is in the code output.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11111</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">n &lt;-<span class="st"> </span><span class="fl">2e4</span></a>
<a class="sourceLine" id="cb9-3" title="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb9-5" title="5">var_theta.hat &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">exp</span>(x))<span class="op">/</span>n</a>
<a class="sourceLine" id="cb9-6" title="6">n1 &lt;-<span class="st"> </span>n<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb9-7" title="7">x1 &lt;-<span class="st"> </span>x[<span class="dv">1</span><span class="op">:</span><span class="st"> </span>n1]</a>
<a class="sourceLine" id="cb9-8" title="8">x2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x1</a>
<a class="sourceLine" id="cb9-9" title="9">theta.hat1 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x1))</a>
<a class="sourceLine" id="cb9-10" title="10">theta.hat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x2))</a>
<a class="sourceLine" id="cb9-11" title="11">theta.hat3 &lt;-<span class="st"> </span>(theta.hat1 <span class="op">+</span><span class="st"> </span>theta.hat2)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb9-12" title="12">var_theta.hat3 &lt;-<span class="st"> </span><span class="kw">var</span>((<span class="kw">exp</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(x2))<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb9-13" title="13">ep_reduction &lt;-<span class="st"> </span>(var_theta.hat <span class="op">-</span><span class="st"> </span>var_theta.hat3)<span class="op">/</span>var_theta.hat</a>
<a class="sourceLine" id="cb9-14" title="14">var_theta.th &lt;-<span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb9-15" title="15">reduction &lt;-<span class="st"> </span>(var_theta.th <span class="op">-</span><span class="st"> </span>var_theta.hat)<span class="op">/</span>var_theta.th</a>
<a class="sourceLine" id="cb9-16" title="16"><span class="kw">cat</span>(<span class="st">&quot; The Monte Carlo simulation of theta is:&quot;</span>,                             </a>
<a class="sourceLine" id="cb9-17" title="17"><span class="st">&quot;The antithetic variate approach of theta is:&quot;</span>, theta.hat3, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb9-18" title="18"><span class="st">&quot;The variance of using Monte Carlo is:&quot;</span>, var_theta.hat, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb9-19" title="19"><span class="st">&quot;The variance of using antitetic variate is:&quot;</span>, var_theta.hat3, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb9-20" title="20"><span class="st">&quot;The percent of empirical estimate of variance reduction is:&quot;</span>, ep_reduction, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&quot;The percent of theoretical estimate of variance reduction is:&quot;</span>, reduction)</a></code></pre></div>
<pre><code>##  The Monte Carlo simulation of theta is: The antithetic variate approach of theta is: 1.718168 
##  The variance of using Monte Carlo is: 1.212593e-05 
##  The variance of using antitetic variate is: 1.933527e-07 
##  The percent of empirical estimate of variance reduction is: 0.9840546 
##  The percent of theoretical estimate of variance reduction is: 0.8585377</code></pre>
</div>
<div id="exercise-5.11" class="section level2">
<h2>Exercise 5.11</h2>
<p>If <span class="math inline">\(\hat{\theta_{1}}\)</span> and <span class="math inline">\(\hat{\theta_{2}}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta_{1}}\)</span> and <span class="math inline">\(\hat{\theta_{2}}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*} = 1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta_{c}} = c\hat{\theta_{1}} + (1 - c)\hat{\theta_{2}}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta_{1}}\)</span> and <span class="math inline">\(\hat{\theta_{2}}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta_{c}} = c\hat{\theta_{1}} + (1 - c)\hat{\theta_{2}}\)</span> in equation (5.11). (<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
For any unbiased estimators <span class="math inline">\(\hat{\theta_{1}}\)</span>, <span class="math inline">\(\hat{\theta_{2}}\)</span> of <span class="math inline">\(\theta\)</span>, then <span class="math display">\[\begin{align}
    E(\hat{\theta_{1}}) = E(\hat{\theta_{2}}) = \theta\notag
    \end{align}\]</span>

The variances of estimators are <span class="math inline">\(Var(\hat{\theta_{1}})\)</span> and <span class="math inline">\(Var(\hat{\theta_{2}})\)</span>.

Since <span class="math inline">\(E(\hat{\theta_{c}}) = E(c\hat{\theta_{1}}) + E((1 - c)\hat{\theta_{2}}) = \theta\)</span>, <span class="math inline">\(\hat{\theta_{c}}\)</span> is unbiased.Then <span class="math display">\[\begin{align}
    Var(\hat{\theta_{c}}) &amp;= Var(c\hat{\theta_{1}} + (1 - c)\hat{\theta_{2}})\notag\\
    &amp;= c^{2}Var(\hat{\theta_{1}}) + (1 - c)^{2}Var(\hat{\theta_{2}}) + 2Cov(c\hat{\theta_{1}}, (1 - c)\hat{\theta_{2}})\notag\\
    &amp;= c^{2}Var(\hat{\theta_{1}}) + (1 - c)^{2}Var(\hat{\theta_{2}}) + 2c(1 - c)Cov(\hat{\theta_{1}}, \hat{\theta_{2}})\notag
    \end{align}\]</span>

Let <span class="math inline">\(f(c) = Var(\hat{\theta_{c}})\)</span>, so we need to find the <span class="math inline">\(c^{*}\)</span> that minimizes the <span class="math inline">\(f(c)\)</span>. Since <span class="math display">\[\begin{align}
    f^{&#39;}(c) &amp;= 2cVar(\hat{\theta_{1}}) - 2(1 - c)Var(\hat{\theta_{2}}) + 2(1 - 2c)Cov(\hat{\theta_{1}}, \hat{\theta_{2}})\notag\\
             &amp;= 2[cVar(\hat{\theta_{1}}) - (1 - c)Var(\hat{\theta_{2}}) + (1 - 2c)Cov(\hat{\theta_{1}}, \hat{\theta_{2}})]\notag
    \end{align}\]</span>

Let <span class="math inline">\(f^{&#39;}(c) = 0\)</span>, we obtain <span class="math inline">\(c = \frac{Var(\hat{\theta_{2}}) - Cov(\hat{\theta_{1}}, \hat{\theta_{2}})}{Var(\hat{\theta_{1}}) + Var(\hat{\theta_{2}}) - 2Cov(\hat{\theta_{1}}, \hat{\theta_{2}}))}\)</span>

<p>After proof, we obtain when <span class="math inline">\(c^{*} = \frac{Var(\hat{\theta_{2}}) - Cov(\hat{\theta_{1}}, \hat{\theta_{2}})}{Var(\hat{\theta_{1}}) + Var(\hat{\theta_{2}}) - 2Cov(\hat{\theta_{1}}, \hat{\theta_{2}}))}\)</span>,which minizes the <span class="math inline">\(Var(\hat{\theta_{c}})\)</span>.</p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{align}
    g(x) = \frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}, x &gt; 1\notag
    \end{align}\]</span>

Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\begin{align}
    \int_{1}^{\infty} \frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx\notag
    \end{align}\]</span>

<p>by importance sampling? Explain.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
Before start, the interval is <span class="math inline">\((1, \infty)\)</span>, so replace the variable: <span class="math inline">\(x = \frac{1}{t}\)</span>,and the interval of variable <span class="math inline">\(t\)</span> is <span class="math inline">\((0, 1)\)</span>. Therefore, <span class="math display">\[\begin{align}
    \theta = \int_{1}^{\infty} \frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx = \int_{0}^{1} \frac{1}{\sqrt{2\pi}*t^{4}}e^{-1/(2t^{2})}dt\notag
    \end{align}\]</span>

The two functions I find are :<span class="math inline">\(f_{1} = \frac{4}{\pi}\frac{1}{1 + t^{2}}\)</span>, <span class="math inline">\(f_{2} = \frac{e^{-x}}{1 - e^{-1}},\ t \in (0 ,1)\)</span>. Then, I am going to verify which of two important functions should produce the smaller variance in estimating

<span class="math display">\[\begin{align}
    \theta = \int_{0}^{1} \frac{1}{\sqrt{2\pi}*t^{4}}e^{-1/(2t^{2})}dt\notag
    \end{align}\]</span>

<p>The process is as follows.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"> t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb11-2" title="2">    w &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb11-3" title="3">    g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">    f1 &lt;-<span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>pi) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">    f2 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="st"> </span>t) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb11-6" title="6">    gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(t)<span class="op">==</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb11-7" title="7">            <span class="kw">expression</span>(f[<span class="dv">1</span>](t)<span class="op">==</span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>pi) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb11-8" title="8">            <span class="kw">expression</span>(f[<span class="dv">2</span>](t)<span class="op">==</span><span class="kw">exp</span>(<span class="op">-</span><span class="st"> </span>t) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb11-9" title="9">    <span class="co">#for color change lty to col</span></a>
<a class="sourceLine" id="cb11-10" title="10">    <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb11-11" title="11">    <span class="co">#figure (a)</span></a>
<a class="sourceLine" id="cb11-12" title="12">    <span class="kw">plot</span>(t, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb11-13" title="13">         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">&#39;(A)&#39;</span>)</a>
<a class="sourceLine" id="cb11-14" title="14">    <span class="kw">lines</span>(t, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-15" title="15">    <span class="kw">lines</span>(t, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-16" title="16">    <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs,</a>
<a class="sourceLine" id="cb11-17" title="17">           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAn1BMVEUAAAAAACsAAFUAK4AAVaorAAArACsrAFUrK1UrK4ArVaorgNRVAABVACtVAFVVKytVK1VVK4BVVStVVVVVVYBVVapVgIBVgKpVqv+AKwCAKyuAK1WAVQCAVVWAVYCAgKqAqoCAsYCA1P+qVQCqVSuqgICq1P+q/6qq///UgCvUgIDUqlXU1IDU/9TU////qlX/1ID/1Kr//6r//9T///9qjs6SAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKrElEQVR4nO2dgZqjthVGmZ1xmsTTtE3aZCdJk3ZpmqFpBq/N+z9bJBAgIYlfwmAJ73++L/HY5l7gLAgkWaJoyCxF6g3IHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiQraDz88MH+VoXxbtX+cfp0L3emGwFVcXjm3wti6J4L/+4vBTHBNuRq6Bex/lZCHpqP+qV3ZZcBdVFf4Y9fD2cY92hdFtyFVQpK2Xx+P/DcDAlOMcyFSTOsPa8klLE331xlOAcy1SQENMKas+0Sp1uZZHgOpapoJM6rdqDpn/Ti7opeQsSLx3tuUVBI0pQVfS8byhIpxMkiuceWSJR0EhXSAtNbVEtRMnimYX0SHeZr1QtQ/3By7yGrFeoA6dpD6X2LW8UB2q7vDkdEhRB2QoSh8u04lWzsqpTqTr8SMnmDp3z8+SSxQazPKEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgDhB/a8JkvQvpCFKUNX3TNVJuqiSECPo8jJoqVJ0ciYhRtD5eegNrj+Zk4xHECCyDFKHEMsgD+3AgP43lc50u2EbQbdOtx3JBO2D7QVVu76K3UDQNMv4T7MHbi9oZ1AQYDtBcmhAeyvEMshJ9fBB3Aq1owIoyEFX1bi8iNtECnLRV1bLxzcKcjFUVssnCnLSaxFVMgpy0lfnLy8UdM98eoK8dVLP4vcgSHagTIezeJnfi2raurczQe5NqJ6EI89UFFbE7F6cDncpSGL903siZnfi8v3XuQu6/DJ3ySu8C52/ev34Xdu4q158EbM7UR2FZytBToI+/n22B6TwLXT+8wfxv29aC+rFEzG3E6cv3uSBOE2QkaDzX+3j5/Sn8bNiXKjt2ZbnQy0Kn9Nn7QhVsYPayzRi/GCI1RF52rkJjlaCjASV9rXIGE1YDAtdXtqZTJ7aSt/gUMVraYrJe/nBEGuup2ubOdoJ8hF0OliXolr/9UMxLtT9X9Rn5I6VRX80qZmWhiHPWsT4yRCrr8gQNCZIKkhu4vn5ePrsX4du/+xqbV0c64kgfaH64d8HvedNZNNeXBGFFqsPHD+58qiAZIJkjb96fGun06rFf23rkcVEkLFQ2R1BWsb2y3EZK6LQY5vfuhljpCpXHhWQStCr2PdfxdWnuzkTps7P84K6AldbSPZqT3bs3Wuj1Y/NCKOPS8aevvv9pzdxg9AtZedRKVIJamfYeOqLBHHEnw6u+sJEkLZQLaMnO9aeN+rFjBB6tJ2t1VQoQtDfWn2uPCpFQkHyxFLX6FFQqaqPSoRXUPeriGBB3ftCjxXR/+iv6RkKktvxjdj7QVDcKVb1890Fn2KjoOHnb6cvPYISnmJaA0P1+Lsop7syqJRTtswK6lbfL9S3x80V0mZE05VCWqxIfvQIyqGQ/iC3Sex+O1NLe7I5W68ngtRCQ7VbuyJbl3kjYvxkrLLLNgBxl/m/V3ceFZHsFBMHjdjEp9Ph20PXx+i4UbQFqdu8or9A61MpTW4UjYjxkzG2zf0fbRI9M4+KSH0nrW2/o6phr35moUlVIyBiNo/KkZGg81/80yIVeKHT56/aS0jEbJ4+SUaCnNV5a+2+hS7/fNVeQiLcDAlUktSCDC6//HfpQh9/ftNeFqQ18yhyE5Qd9yQoqnMjlJwEzeQPWvVc58Zi7kmQxNe5sZiMBK3hR7VdrEiugkDnjQfZuWFGrrFVWQoCnTduunYBI3KNrUoqqBwrQJP0/s4bvSNooB47N/TIq0ksSJtS1Mpeau1c+ntrWsnuQ61zI7ruNcN2gkLGrJ6fZwR5Om9qZ0qjOadecabbzQQFjVmtHn/0C3J33pgdQZcfhjmS3b02V7OVoKARh6JQLfUOmkbvhxmb9YqmMRr5HIK8DYJXs5WgkDGrUqIpSO+H8bcsBwha72eRKY8g+cXkCNL6Yfx9EwGC1iuENiyD0JjV9q5lKmjsh8GC9P6h/QnCY1b7B2G813OP/TDDiVKodPd1ioVS6gVxo/fD+Dtv7qKQDmUiSOuH8XfeuAW5e22u5gaCZsdqTATp/TDezhuXIF+vzdUk7VmdT60qDMXkfQD7qGrEbsaU5Z03eq/N1WQiyMboe+kI7LxxRF5BroKWd944I5eTqyA/N96K7epi40CadceL3YmgzcbR3fow3rLBbNHF1m6YX9Z+H5xeX4ejwX/DMqhe8rBcV8P8kvb7iPT6OuwG/8wKaetKXrc/rIprv49IP6ZwjPPo15eToOk9sKqDRrXfR6TXU9jjPPoVZiTI+g2eEhTVfh+RXk9hjfMYVphOEBys0bfFh7Tf63m77p+4sSDWOI9hhakEHQMGa6gjKKT9fkTOqyJ/yRo3FsQa59H0a0wl6F3AYI1BEG6/12KO6puosSDTH6ErEgo6BAzWGATh9vuBrhQ5haTXU0yHMSgSCioCBmuECtLb7+uxrTtmLEh+gpqAwRqTU2yu/X5gvA5FjQXJ7xRrAgZrTArpufb7aUxIej1FfoX0Q8BgDTT4wnsVa8qQ9HqK/C7zryGDNbq2+JD2e42qa2OJGwuS442iAg/WWN5+H5Re/y7HqgYcrHHd4IuwsSCTcR4DmQly1reXt98HpdfXYa8qB0EGdsP81YMvAuL84zyyE5QbmfSs5guPIAAFASgIQEEACgJQECBlg9k+SChoceA291C9D/uL4Awrbs016Ta7x9SOGuPj4PiVN2dx4IaFocvR3gRtX0mZONqZoI1KIHstg6N9CbqNH7WmfQpadytCVrn6gi1wSOaiPU3RSrKNIDwkc8mu3u4E01e6+oJN0IC6ZYIWBF3LJoIChmQu2Nc0zZD7OYKSnGDblUFoSGb0zibys9VVDD9GNCpdOj97uQ9K5mcXgnwtETdha0G+IZljZTC05SoRqToOC+uDHO00+zjFkkJBgF1VVlOwp8pqEpJVNXbDFoJC5g8KSgq+v+7ra8OvWDxoBqqQpPcqKKCyGpb0bgXhympY0vsVtFJSCrruewqioOu+p6BPXtA9QUEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBrCqrVsyHsN/HhjfEEnOhwOZHFOk8lW1GQnCFjmCXDeBMf3hhPwIkOr/qpT65nPUFdp5CaJsN4Ex/emE/AiV/7U+Ta/awnSD1tt+tRNN7EhzfmE3BiwzMV1E0KpQTpb+LDzSfgxIdneYp1BYAxY09MIWRGGE/AiQ9fcInwkakg4wk48eGlnObssMpzJvI8xcwn4MSHR5eAfvIspI0n4MSHxx+/frK9zEceQUa4moYysyNo7RvFyDtpIzzLMqg9MeQWdnchVfR1xAhvoqsaRricmXOdZwGxsgqgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAXYgqF7n97wLyV+QNudMCigIkL2g/tnZqcheEI8gBAUBKAhAQQAKAlAQYPok6xuTvyD17OxU7EBQWigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAfITmRIH3ZX6QAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">    <span class="co">#figure (b)</span></a>
<a class="sourceLine" id="cb12-2" title="2">    <span class="kw">plot</span>(t, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb12-3" title="3">        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&#39;(B)&#39;</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="kw">lines</span>(t, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">    <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-6" title="6">           <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11111</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb13-3" title="3">est &lt;-<span class="st"> </span>var &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">g &lt;-<span class="st"> </span><span class="cf">function</span>(t) {</a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">4</span>) <span class="op">*</span><span class="st"> </span>(t <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">  }</a>
<a class="sourceLine" id="cb13-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f1</span></a>
<a class="sourceLine" id="cb13-8" title="8">t &lt;-<span class="st"> </span><span class="kw">tan</span>((pi <span class="op">*</span><span class="st"> </span>u) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-9" title="9">g_f1 &lt;-<span class="st"> </span><span class="kw">g</span>(t) <span class="op">/</span><span class="st"> </span>((<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>pi) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb13-10" title="10">est[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(g_f1)</a>
<a class="sourceLine" id="cb13-11" title="11">var[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(g_f1)</a>
<a class="sourceLine" id="cb13-12" title="12">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f2</span></a>
<a class="sourceLine" id="cb13-13" title="13">t &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>u)</a>
<a class="sourceLine" id="cb13-14" title="14">g_f2 &lt;-<span class="st"> </span><span class="kw">g</span>(t) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="st"> </span>t) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb13-15" title="15">est[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(g_f2)</a>
<a class="sourceLine" id="cb13-16" title="16">var[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(g_f2)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="kw">print</span>(<span class="kw">c</span>(var))</a></code></pre></div>
<pre><code>## [1] 0.1096357 0.1283691</code></pre>
From the two important functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span>, in the result of running the code, we obtained the estimated variances are <span class="math inline">\(0.1096357\)</span> by <span class="math inline">\(f_{1}\)</span>,and <span class="math inline">\(0.1283691\)</span> by <span class="math inline">\(f_{2}\)</span>. Hence, the important functions <span class="math inline">\(f_{1} = \frac{4}{\pi}\frac{1}{1 + t^{2}}\)</span> produce the smaller variance in estimating

<span class="math display">\[\begin{align}
    \int_{1}^{\infty} \frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx\notag
    \end{align}\]</span>

</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
We divide the interval <span class="math inline">\((0, 1)\)</span> into five subintervals: <span class="math inline">\(((i-1)/5, i/5), i = 1,2,\ldots,5\)</span>.

Then on <span class="math inline">\(i^{th}\)</span> subinterval variables generated from the density

<span class="math display">\[\begin{align}
    \frac{4c_{i}}{\pi}\frac{1}{1 + t^{2}}, \ (i - 1)/5 &lt; t &lt; i/5\notag
    \end{align}\]</span>

<p>Where <span class="math inline">\(c_{i} = \frac{\pi}{4(arctan\frac{i}{5} - arctan\frac{i-1}{5})}, \ i = 1,2,\ldots,5\)</span> From the important function:<span class="math inline">\(f_{1} = \frac{4}{\pi}\frac{1}{1 + t^{2}}\)</span>, we obtain the stratified importance sampling estimate is:<span class="math inline">\(\hat{\theta_{1}} = 0.3426892\)</span>. Use Monte Carlo integration with antithetic variables to estimate is: <span class="math inline">\(\hat{\theta_{2}} = 0.3938162\)</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">M &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb15-3" title="3">k &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb15-4" title="4">r &lt;-<span class="st"> </span>M<span class="op">/</span>k</a>
<a class="sourceLine" id="cb15-5" title="5">N &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb15-6" title="6">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb15-7" title="7">est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-8" title="8">g &lt;-<span class="st"> </span><span class="cf">function</span>(t) {</a>
<a class="sourceLine" id="cb15-9" title="9">  <span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">*</span><span class="st"> </span>t<span class="op">^</span><span class="dv">4</span>) <span class="op">*</span><span class="st"> </span>(t <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-10" title="10">}</a>
<a class="sourceLine" id="cb15-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb15-12" title="12">  est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M)))</a>
<a class="sourceLine" id="cb15-13" title="13">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">tan</span>(<span class="kw">atan</span>((j<span class="dv">-1</span>)<span class="op">/</span>k) <span class="op">+</span><span class="st"> </span>(<span class="kw">atan</span>(j<span class="op">/</span>k)<span class="op">-</span><span class="kw">atan</span>((j<span class="dv">-1</span>)<span class="op">/</span>k)) <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k, (j <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>k, j <span class="op">/</span><span class="st"> </span>k))))</a>
<a class="sourceLine" id="cb15-14" title="14">  est[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</a>
<a class="sourceLine" id="cb15-15" title="15">}</a>
<a class="sourceLine" id="cb15-16" title="16">theta_hat &lt;-<span class="st"> </span><span class="kw">apply</span>(est, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb15-17" title="17">theta_hat1 &lt;-<span class="st"> </span>theta_hat[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb15-18" title="18"><span class="kw">set.seed</span>(<span class="dv">111112</span>)</a>
<a class="sourceLine" id="cb15-19" title="19">M &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb15-20" title="20">t2 &lt;-<span class="st"> </span><span class="kw">runif</span>(M)</a>
<a class="sourceLine" id="cb15-21" title="21">theta_hat2 &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="kw">g</span>(t2) <span class="op">+</span><span class="st"> </span><span class="kw">g</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>t2)) <span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-22" title="22">theta_hat1</a></code></pre></div>
<pre><code>## [1] 0.3426892</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">theta_hat2</a></code></pre></div>
<pre><code>## [1] 0.3938162</code></pre>
</div>
<div id="exercise-6.4" class="section level2">
<h2>Exercise 6.4</h2>
<p>Suppose that <span class="math inline">\(X_{1}, ..., X_{n}\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
Suppose the distribution of random variable <span class="math inline">\(X\)</span> is <span class="math inline">\(LN(\mu, \sigma^{2})\)</span>, the parameters are unknown. So, suppose <span class="math inline">\(Y = logX\)</span>, then <span class="math inline">\(Y = logX \sim N(\mu, \sigma^{2})\)</span>. Then we can obtain the <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span> with unknown <span class="math inline">\(\sigma^{2}\)</span> by <span class="math inline">\(t\)</span> statistic, that have <span class="math inline">\(t = \frac{\sqrt{n}(\overline{y} - \mu)}{s} \sim t(n - 1)\)</span>. Therefore, we can get the <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span> is:

<span class="math display">\[\begin{align}
    \overline{y} \pm t_{0.025}(n-1)s/\sqrt{n}\notag
    \end{align}\]</span>

which means the <span class="math inline">\(95\%\)</span> confidence interval is:

<span class="math display">\[\begin{align}
    \overline{logx} \pm t_{0.025}(n-1)s/\sqrt{n}\notag
    \end{align}\]</span>

Where the <span class="math inline">\(\overline{logx} = \frac{1}{n}\sum\limits_{i = 1}^{n}logx_{i}\)</span>, <span class="math inline">\(s = \sqrt{\frac{1}{n - 1}\sum\limits_{i = 1}^{n}(logx_{i} - \overline{logx})^{2}}\)</span>.

<p>Then, suppose <span class="math inline">\(\mu = 0, \sigma^{2} = 1\)</span> we use a Monte Carlo method to obtain an empirical estimate of the confidence level. The process is as follows.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb19-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n, <span class="dt">meanlog =</span> <span class="dv">0</span>, <span class="dt">sdlog =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">y &lt;-<span class="st"> </span><span class="kw">log</span>(x)</a>
<a class="sourceLine" id="cb19-5" title="5">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb19-6" title="6">qt1 &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-7" title="7">sd1 &lt;-<span class="st"> </span><span class="kw">sd</span>(y)</a>
<a class="sourceLine" id="cb19-8" title="8">cl_lower &lt;-<span class="st"> </span>mean_y <span class="op">-</span><span class="st"> </span>qt1 <span class="op">*</span><span class="st"> </span>(sd1 <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb19-9" title="9">cl_upper &lt;-<span class="st"> </span>mean_y <span class="op">+</span><span class="st"> </span>qt1 <span class="op">*</span><span class="st"> </span>(sd1 <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb19-10" title="10"><span class="kw">print</span>(<span class="kw">c</span>(cl_lower, cl_upper))</a></code></pre></div>
<pre><code>## [1] 0.1632449 0.3865424</code></pre>
<p>From the result of running the code, we obtain an empirical estimate of the confidence level is:<span class="math inline">\((0.1632449, 0.3865424)\)</span>.</p>
</div>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
Because <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20, the mean of variable is <span class="math inline">\(\mu\)</span>. Then we need to obtain the <span class="math inline">\(\hat{\theta_{L}}\)</span> and <span class="math inline">\(\hat{\theta_{U}}\)</span> that satisfied

<span class="math display">\[\begin{align}
    P(\hat{\theta_{L}} \leq \mu \leq \hat{\theta_{U}}) &amp;= 1 - 0.05, \notag\\
    P(\mu \leq \hat{\theta_{L}}) &amp;= 0.025 \notag\\
    P(\mu \geq \hat{\theta_{U}}) &amp;= 0.025 \notag
    \end{align}\]</span>

Then, because <span class="math inline">\(P(\mu \leq \hat{\theta_{L}}) = P(n\mu \leq n\hat{\theta_{L}}) = P(\sum\limits_{i = 1}^{n}X_{i} \leq n\hat{\theta_{L}}) = 0.025\)</span>

<span class="math inline">\(P(\mu \geq \hat{\theta_{U}}) = P(n\mu \geq n\hat{\theta_{U}}) = P(\sum\limits_{i = 1}^{n}X_{i} \geq n\hat{\theta_{u}}) = 0.025\)</span>

<p>where <span class="math inline">\(\sum\limits_{i = 1}^{n}X_{i} \sim \chi_{2n}^{2} = \chi_{40}^{2}\)</span>.So we use a Monte Carlo experiment to estimate the coverage probability of the t-interval of <span class="math inline">\(\mu\)</span>. The process is as follows.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb21-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">mean_x &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb21-5" title="5">qchi1 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.025</span>, <span class="dt">df =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb21-6" title="6">qchi2 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">cl_lower &lt;-<span class="st"> </span>qchi1 <span class="op">/</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb21-8" title="8">cl_upper &lt;-<span class="st"> </span>qchi2 <span class="op">/</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="kw">print</span>(<span class="kw">c</span>(cl_lower, cl_upper))</a></code></pre></div>
<pre><code>## [1] 1.221652 2.967085</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb23-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-4" title="4">mean_x &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb23-5" title="5">qt2 &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-6" title="6">sd2 &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb23-7" title="7">cl_lower &lt;-<span class="st"> </span>mean_x <span class="op">-</span><span class="st"> </span>qt2 <span class="op">*</span><span class="st"> </span>(sd2 <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb23-8" title="8">cl_upper &lt;-<span class="st"> </span>mean_x <span class="op">+</span><span class="st"> </span>qt2 <span class="op">*</span><span class="st"> </span>(sd2 <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb23-9" title="9"><span class="kw">print</span>(<span class="kw">c</span>(cl_lower, cl_upper))</a></code></pre></div>
<pre><code>## [1] 1.587442 2.139228</code></pre>
<p>From the result of running the code, we obtain an empirical estimate of the confidence level is:<span class="math inline">\((1.221652, 2.967085)\)</span>. And t-interval results with the simulation results in Example 6.4 is <span class="math inline">\((1.587442, 2.139228)\)</span></p>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="exercise-6.7" class="section level2">
<h2>Exercise 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>Suppose that <span class="math inline">\(\alpha \in [1, 100]\)</span>, then plot the power of the skewness test, in the picutre of <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distribution, the power is close to 0.05, therefore the skewness of symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions have normality for all <span class="math inline">\(\alpha \in [1, 100]\)</span>. Similarly, suppose that <span class="math inline">\(\nu = 1, 2, \ldots, 100\)</span>, in the picture we can see that when <span class="math inline">\(\nu\)</span> is small, the power is bigger than 0.1 for <span class="math inline">\(\nu &lt; 10\)</span>, so the skewness of <span class="math inline">\(t(\nu)\)</span> do not have normality for small <span class="math inline">\(\nu\)</span>. But as the <span class="math inline">\(\nu\)</span> get larger and larger, we know that <span class="math inline">\(t(\nu) \rightarrow N(0, 1)\)</span> from the basics of statistics. In the picture we can see that the skewness of <span class="math inline">\(t(\nu)\)</span> distribution have normality when <span class="math inline">\(\nu\)</span> increases. The process is shown below.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">set.seed</span>(<span class="dv">11111</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span> <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb25-3" title="3">alpha1 &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb25-4" title="4">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha1<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>((<span class="dv">6</span><span class="op">*</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>((n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(n <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)))) </a>
<a class="sourceLine" id="cb25-5" title="5">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb25-6" title="6">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb25-7" title="7">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-8" title="8">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-9" title="9">  <span class="kw">return</span>(m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb25-10" title="10">}</a>
<a class="sourceLine" id="cb25-11" title="11">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb25-12" title="12">alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb25-13" title="13">N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</a>
<a class="sourceLine" id="cb25-14" title="14"><span class="co"># beta</span></a>
<a class="sourceLine" id="cb25-15" title="15">pwr_beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb25-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb25-17" title="17">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb25-18" title="18">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb25-19" title="19">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, alpha[i], alpha[i])</a>
<a class="sourceLine" id="cb25-20" title="20">    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb25-21" title="21">  }</a>
<a class="sourceLine" id="cb25-22" title="22">  pwr_beta[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb25-23" title="23">}</a>
<a class="sourceLine" id="cb25-24" title="24"><span class="co">#t(nu)</span></a>
<a class="sourceLine" id="cb25-25" title="25">nu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb25-26" title="26">N1 &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</a>
<a class="sourceLine" id="cb25-27" title="27">pwr_t &lt;-<span class="st"> </span><span class="kw">numeric</span>(N1)</a>
<a class="sourceLine" id="cb25-28" title="28"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N1) {</a>
<a class="sourceLine" id="cb25-29" title="29">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb25-30" title="30">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb25-31" title="31">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> nu[i])</a>
<a class="sourceLine" id="cb25-32" title="32">    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb25-33" title="33">  }</a>
<a class="sourceLine" id="cb25-34" title="34">  pwr_t[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb25-35" title="35">}</a>
<a class="sourceLine" id="cb25-36" title="36"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;ggplot2&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co">#plot power of beta(alpha, alpha)</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">plot</span>(alpha, pwr_beta, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span> ,<span class="dt">xlab =</span> <span class="st">&quot;alpha&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">lines</span>(alpha, pwr_t, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Power beta vs t&quot;</span>))</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;t&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAACsAAFUAAP8AKysAK1UAK4AAVVUAVYAAVaorAAArACsrKwArK1UrVVUrVYArVaorgKorgNRVAABVACtVKwBVKytVgIBVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgCuAgFWAgKqAqoCAqtSAqv+A1KqA1P+qVQCqVSuqVYCqgFWq1ICq1Kqq1NSq1P+q/6qq/9Sq///UgCvUgFXUqlXUqoDU1KrU1NTU////AAD/qlX/1ID/1Kr//6r//9T///++5MrtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL8klEQVR4nO2dAZujthGGWTu7yfquTWvncm28Sdu0NUnTXHs0uRq8Nv//X0UzkkDCiEFYwlrvfM9zPoykEbw7GgkQclazBpVd+wBSFwMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEJxARWZ1O8+TCufZ4uPfftPP/budsu7QKN5AGV3u0nlHYCe3/Vzc8q7QKuZAGUP+ynlHYBcjuVrZ4xiA8IDe95IF/r16yz77E97OOAH/My2dV3B5+kH4WV/2GORu+/fZQvZJsWJ/VuU+RK/NXlyIC4M//oOWq/2TQUBzdX/eyvyfvmhSZIFpmgWQHDWu8afBJsKvh83WbaWJwabQvcfdSblcLnyP7DS5lHnW9mtV5KR7Iu2WGMmZUCfNvD/YaWOfQ2bW/jIHuvTk/jIwWXE9zUCevhQ/1+Wz/HLL5DPzIPOIgp+sVc7QGgIMK7h43EPxVRSyk3MiEHqKOE/PJkC/6zACs9K4SykI0jl0j+UkzV5mvP99K+3CE9VhsVFCWHz/mfzONIHJI5aQHlQQWYnPh72efb55m5XSEhNtsLs8dSJwT4zj9x9+k7u0IAAtaxEfGYq2ll2pmgWQBguwe9hH8YKEYT+ucm+ecrWEDOqzAmoYWrm0U0su//bp00DCNxStbjndzLrPxo7yQJqD8zyIEHr9ytwn883OiQ1RZwetLV2SxbHFhDU9hdd+vmvb43BxYsAZMYg2bFI15G4jLO0AKmeCWPQo2VJ9lptkMZtc8B1+tboxl4CIKMXw4YmThi6bjkiuvsGRkuYbgNatL2YnQfNPT+1MUhS30rjf9xDO9O0LKN+mhGQMQ6Sf+0txhE4PzXGkYMlG1B3HASpQHfx36fMDtK4X9b3Q+cCp0p8HKSFI+k/46ZAo8aOGFmev1upAXM3BrUj6TYPjKnvP0Avdv93s4q2Gf4CEai9RJYFJp0C3+4gxIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEKBAWUvRtcCFNZcJJM+VhnQvNUzIIcV76btYTu8SR+r7EHzVs+A5jUXyaSPVQY0b/UMaF5zkUz6WGVA81bPgOY1F8mkj1UGFLT6PMse8Y3ZrSNDAoAOq7ODq84PNw6gAl/uxrfT1/05lLnlculjd1DnR1iW5UD+c0DHzUyATk8CS4XvuxWOtTikuaX6F0RnR1iqfw5dERBWVMkVMhwvOKI5ySYUoe4RlsZnnw6r9yu15gK8A4rvVMt1DczIcFUPigCoHJSV/7DCN35hlQu1gX/Y/FHuMK2Orn6smhiEqJzmru1BuIQFvEiOr1fDxrY+frWzWt91e7EEYpBwdOnr4quOQZVx3FceB121F3uzk596MQsJSMSjxU/RPWhuc1NMdjyolp0L7o3fxBoVQ71YWPkDwhj0sG96d9jAbre6WhNL6aY99mKIAjut/G4H0RqcRy1B5Gf1FpvY+5WKxnIJJ7nKTgErVeRNP/+KAQW26lf9SS0o4lwo5JUDKnQbrrLhi9WAw6CXBMgYPw9frNavFJBxVTx4sQp6lYDYgygVeqD1GmOQ8wLdlFomy710bQqAem6wXmC1ydh3281fCQAadyITmpgr7nppFkDD9wpiAdKtZ/qKg5a5iICG7zapG6zeVi/O6GkuHiDqfmW0JhZEsS41loOy8scDdIRVLvMRfVmIeqebvJoHVXc7vMt0EaE5LlaJO96xAME4CMbHrnuFnubCKZ1ebIuALuvtE7jdEduD8mk/8NA1F+65hj+gMUFicgwqnI+8vMwFfDLm7ZR5rHEQDhWnrbvcvWkf8tlqKherQetlQIS5WwRkrhl/eb3XjEFhrbYZjSXRA9R7vV4ssNVuxuPmpY+DAlu1MoITBfKgcEoGENxIufie2Q0DurBt+dZ7VZM+Vo2MwoUu7sduGlDd/szFsHqmanvXO15JARpuac1ta/ed61sGlNM37dXzwpk9KI5GV683jpsRPfxxAxfK8wKKo2jXYjlOzn6dgPDnuUgvKrL1KEAhZwJH0JQbZupHFqlu7LD6bASgoHPJI2j65AXXxJZWpyc3RPNqPmlC0ycvhLlpf4OAxnsQ5iLGQTcIaHQM6rVyNry4vRg0thcba+72erF56722IgG6xkTyOJr8XGwwRHtMJE9d056s1tZrnWfymQZcJx6FpnTzsvsaeDbvM5E89X5swkDxK+k6AwNFLw9KfCQ03YOGBooeE8lvD5B6X3F4oDh+IvntARpxP9Wv3luLQeHrvbFeLEK9KRNKAVDSbSwBQGlHaQZEKBFA6UahBAAJQst0CaUASNFJk1AigNrP1MSACM0MyDEnQLYwBuQ2B1EoST6pAKr7XglMQqkAkn19gl6UCiBkk6ITpQQoyQFjQoCWtev95GsqFUCN+yg+yTBKBlCtwWhXSiQipQOocaIuo6bNac+atREm9Wxe0ak7nx1UnaUU9Ib+6CM3xNNKO88YB9D0Z/OtlxhRu11xwvaiHmxDi1MQ61aowLesLReNAsjz2bwt43BNRj2b4rPEjdI8ydreodM7u+zEni+lQhQFkN+zeVNy/d5SnVJpHXlpbdbnCU2ZugVnFGr3GMXNWnRhua2aW1Ie1K4cvjx3jrLvbHrI6c26F+IZ2v7CmmK8GDT+2byNBvGAG3WbRcur7O7Qn8aZ17abtE7V32rLnoQ6JiCfZ/MNlLJutjQm5UtCy351HKw8292SK2V6t0ma2x3mZURAY81ZbtNQMQFZ38ycS8tDOo5C0BxKbxtxHS0GjTZX1pbb1D2ONPQbBzJ7m38pvc3aQhesu05Ytjt0aQ1F71xG7MUMDU4kb73EgjKCjZ2p7jDV5OraICj/N9a5l/vqji0ju995x7gnfd6M7K1OYeuke2Tsd2WZcMTBM3qYK2urVYU7q4BKJAYlSEbpyheracMBpXaxmpyudqnxYhQD0IiL1XFGifTLki8tfkH2ER40zuitAhpxsTrO6M0Coi9Wxxm9XUCBjDKgy9IZEAO6LJ0BvXpAtyQGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYEKHwgCr3Qmj43HE9mEmuztOfDIusPQ6Uht++3hKH4K3ggGCdpqr/8E5PYn8B5+jMVOHt7v7kSiQdN+7Shf4Z9YFD8FdoQPLRUN67tLlcA7ZYfHRmwt+Ac9iQe92lT0+PcvfQIfgrNKAGgjOH+Ns6MxUP3wpA/cmHN7vBKhpA9CH4KDggPI2hB6/54qMrk9gPMag/uVr8Z4MRzFVaNzH6EHwUGpBs+wMRAJ45OjJB2wBA/ckFzCkBN3FWoWIzeQhemhtQpWN0Tyb9+28OQHfKMVxVCNcUzcuJf6JmbmLymXV/JtzrbmIyqIgA46iiCT1pN7HhCFmYvxrQzVSoiSnb/mR5xuLsHVU0jpN2kB7sY/Xkh4FMubObl5NvKmc3L7m40ydqzoEiBAgqU+4eKBaanaO0jkFpDxSxpTgOTrUhSHVmkpca/cmVvlBxlM6J9Enii1VCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyKULiBjKRVre2YxIEIMiFCCgHI5YV5AObz5foUzWo6b9ys5iz7Xs+nnUnqAYGoYTNgEQCsBA2b2HjcwR1/804nzKTlA+IvBMJ0OAeHk+of9cbPGnU3ifEoOEKjKMgUIpx3e7TAGqUBUzdvG0gNUZNniJ+VBb9TE1QaQTpxPyQFCrzk4ADWJ8yk5QDgdusqMGJRDDJKAmsT5lBwg6Tyib0dA6v0U04MwcT4lB0jO4c2xWR1WavhjxiBMnO9w0gNkaN5o0y8GRIgBEUoaUApiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAER+g3EcklBNMhHTwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="exercise-6.8" class="section level2">
<h2>Exercise 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} \overset{.}{=}0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>Repeat the simulation of Example 6.16 as follow. And compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} \overset{.}{=}0.055\)</span>. Also compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small(20), medium(100), and large(500) sample sizes.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb28-3" title="3">sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb28-4" title="4">sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb28-5" title="5">cout5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</a>
<a class="sourceLine" id="cb28-6" title="6">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb28-7" title="7">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb28-8" title="8">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb28-9" title="9">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb28-10" title="10">  <span class="co"># return 1 (reject) or 0 (do notreject H0)</span></a>
<a class="sourceLine" id="cb28-11" title="11">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb28-12" title="12">}</a>
<a class="sourceLine" id="cb28-13" title="13">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb28-14" title="14">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb28-15" title="15">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb28-16" title="16">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m , <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb28-17" title="17">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb28-18" title="18">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb28-19" title="19">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb28-20" title="20">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb28-21" title="21">  <span class="kw">cout5test</span>(x, y)</a>
<a class="sourceLine" id="cb28-22" title="22">})</a>
<a class="sourceLine" id="cb28-23" title="23"><span class="kw">mean</span>(tests)</a></code></pre></div>
<pre><code>## [1] 0.3116</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># F test with alpha = 0.055</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co"># normality test</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">shapiro.test</span>(x)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x
## W = 0.90004, p-value = 0.04131</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">shapiro.test</span>(y)<span class="co"># if p_value &lt; 0.1, we need generate new sample</span></a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  y
## W = 0.92679, p-value = 0.1339</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">var.test</span>(x, y, <span class="dt">ratio =</span> <span class="dv">1</span>, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>), <span class="dt">conf.level =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 0.43569, num df = 19, denom df = 19, p-value = 0.07796
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.1759481 1.0788899
## sample estimates:
## ratio of variances 
##          0.4356933</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">#p_value = 0.398</span></a>
<a class="sourceLine" id="cb36-2" title="2"></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co"># for moderate, large sample</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb36-5" title="5">N1 &lt;-<span class="st"> </span>N2 &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb36-6" title="6">c5test &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb36-7" title="7">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb36-8" title="8">  y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb36-9" title="9">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m , <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb36-10" title="10">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb36-11" title="11">  y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb36-12" title="12">  X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb36-13" title="13">  Y &lt;-<span class="st"> </span>y1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb36-14" title="14">  <span class="kw">cout5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb36-15" title="15">})</a>
<a class="sourceLine" id="cb36-16" title="16">  <span class="kw">mean</span>(tests)</a></code></pre></div>
<pre><code>## [1] 0.8446</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># 0.85</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co"># F test with alpha = 0.055</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co"># normality test</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">shapiro.test</span>(x1)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x1
## W = 0.96587, p-value = 0.01078</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">shapiro.test</span>(y1)<span class="co"># if p_value &lt; 0.01, we need generate new sample</span></a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  y1
## W = 0.98856, p-value = 0.5507</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">var.test</span>(x1, y1, <span class="dt">ratio =</span> <span class="dv">1</span>, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>), <span class="dt">conf.level =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x1 and y1
## F = 0.42084, num df = 99, denom df = 99, p-value = 2.329e-05
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.2855364 0.6202623
## sample estimates:
## ratio of variances 
##          0.4208414</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co">#p_value = 0.398</span></a>
<a class="sourceLine" id="cb44-2" title="2"></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#large sample</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb44-5" title="5">N1 &lt;-<span class="st"> </span>N2 &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb44-6" title="6">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb44-7" title="7">  y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb44-8" title="8">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m , <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb44-9" title="9">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb44-10" title="10">  y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb44-11" title="11">  X &lt;-<span class="st"> </span>x2 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb44-12" title="12">  Y &lt;-<span class="st"> </span>y2 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb44-13" title="13">  <span class="kw">cout5test</span>(x2, y2)</a>
<a class="sourceLine" id="cb44-14" title="14">})</a>
<a class="sourceLine" id="cb44-15" title="15">  <span class="kw">mean</span>(tests)</a></code></pre></div>
<pre><code>## [1] 0.9895</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co"># 0.85</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="co"># F test with alpha = 0.055</span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co"># normality test</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="kw">shapiro.test</span>(x2)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x2
## W = 0.99656, p-value = 0.3628</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">shapiro.test</span>(y2)<span class="co"># if p_value &lt; 0.01, we need generate new sample</span></a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  y2
## W = 0.99701, p-value = 0.4932</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">var.test</span>(x2, y2, <span class="dt">ratio =</span> <span class="dv">1</span>, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>), <span class="dt">conf.level =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x2 and y2
## F = 0.42973, num df = 499, denom df = 499, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 94.5 percent confidence interval:
##  0.3618269 0.5103783
## sample estimates:
## ratio of variances 
##          0.4297308</code></pre>
<p>From the results of running the code, the empirical power of the test is 0.3116.</p>
<p><span class="math inline">\(F\)</span> test of equal variance, <span class="math inline">\(p-value = 0.07796 &gt; \hat{\alpha}\)</span>at significance level <span class="math inline">\(\hat{\alpha} \overset{.}{=}0.055\)</span>. So we can say the variance are equal at sample size n = 20.</p>
<p>For small(20), medium(100), and large(500) sample sizes. The power of the Count Five test are 0.3116, 0.8446, 0.9895, and the power of the <span class="math inline">\(F\)</span> test are 1 - 0.07796, 1 - 2.329e-05, 1 - 2.2e-16.</p>
</div>
<div id="exercise-6.c" class="section level2">
<h2>Exercise 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are <span class="math inline">\(i.i.d\)</span>, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\begin{align}
        beta_{1,d} = E[(X - \mu)^{T}\Sigma^{-1}(Y - \mu)]^{3}\notag
        \end{align}\]</span> Under normality, <span class="math inline">\(\beta_{1,d} = 0\)</span>. The multivariate skewness statistic is <span class="math display">\[\begin{align}
        b_{1,d} = \frac{1}{n^{2}}\sum\limits_{i, j = 1}^{n}[(X_{i} - \bar{X})^{T}\hat{\Sigma}^{-1}(X_{j} - \bar{X})]^{3}\notag
        \end{align}\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>The process is shown below.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb52-3" title="3">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb52-4" title="4">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb52-5" title="5">Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-6" title="6">x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</a>
<a class="sourceLine" id="cb52-7" title="7">x2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</a>
<a class="sourceLine" id="cb52-8" title="8">msk &lt;-<span class="st"> </span><span class="cf">function</span>(x1, x2){</a>
<a class="sourceLine" id="cb52-9" title="9">  x1bar &lt;-<span class="kw">colMeans</span>(x1)</a>
<a class="sourceLine" id="cb52-10" title="10">  x2bar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x2)</a>
<a class="sourceLine" id="cb52-11" title="11">  xbar &lt;-<span class="st"> </span>(x1bar <span class="op">+</span><span class="st"> </span>x2bar) <span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-12" title="12">  t_x1 &lt;-<span class="st"> </span><span class="kw">t</span>(x1 <span class="op">-</span><span class="st"> </span>xbar)</a>
<a class="sourceLine" id="cb52-13" title="13">  x2_ &lt;-x2 <span class="op">-</span><span class="st"> </span>xbar</a>
<a class="sourceLine" id="cb52-14" title="14">  Sigma_hat &lt;-<span class="st"> </span>(<span class="kw">var</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">var</span>(x2)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-15" title="15">  Sigma_hat_inv &lt;-<span class="st"> </span><span class="kw">solve</span>(Sigma_hat)</a>
<a class="sourceLine" id="cb52-16" title="16">  z &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x1) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-17" title="17">  t &lt;-<span class="st"> </span><span class="kw">length</span>(x1) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-18" title="18">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>t) {</a>
<a class="sourceLine" id="cb52-19" title="19">    z[i] &lt;-<span class="st"> </span>(t_x1[,i] <span class="op">%*%</span><span class="st"> </span>Sigma_hat_inv <span class="op">%*%</span><span class="st"> </span>(x2_[i,]))<span class="op">^</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span>n<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-20" title="20">  }</a>
<a class="sourceLine" id="cb52-21" title="21">  <span class="kw">return</span>(<span class="kw">sum</span>(z))</a>
<a class="sourceLine" id="cb52-22" title="22">}</a>
<a class="sourceLine" id="cb52-23" title="23">p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb52-24" title="24">cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-25" title="25">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb52-26" title="26">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb52-27" title="27">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb52-28" title="28">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb52-29" title="29">    x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</a>
<a class="sourceLine" id="cb52-30" title="30">    x2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</a>
<a class="sourceLine" id="cb52-31" title="31">    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">msk</span>(x1, x2)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb52-32" title="32">  }</a>
<a class="sourceLine" id="cb52-33" title="33">  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb52-34" title="34"></a>
<a class="sourceLine" id="cb52-35" title="35">  }</a>
<a class="sourceLine" id="cb52-36" title="36"></a>
<a class="sourceLine" id="cb52-37" title="37">p.reject</a></code></pre></div>
<pre><code>##  [1] 0.0012 0.0015 0.0013 0.0006 0.0010 0.0010 0.0016 0.0011 0.0013 0.0011</code></pre>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>1.If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>2.What is the corresponding hypothesis test problem?</p>
<p>3.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p>Not necessarily, because the value of powerS are very close, so we have to do a hypothesis test to get a further conclusion.</p></li>
<li><p>For methods A and B. The corresponding hypothesis problem is: <span class="math inline">\(H_{0}:power_{A} = power_{B}, H_{1}:power_{A} \neq power_{B}\)</span></p></li>
<li><p>The Z-test and two-sample t-test require that the samples are independent, which may not be applicable here. So we can use the paired-test or McNemar test.</p></li>
</ol>
<p>4.To test our hypothesis, the information we need is the frequency <span class="math inline">\(a\)</span> that method A accepts but method B rejects, the frequency <span class="math inline">\(b\)</span> that method A rejects but method B accepts. In this case, if the null hypothesis is true, <span class="math inline">\(\frac{(a - b)^{2}}{a + b} \sim \chi_{1}^{2}\)</span>. In this way, we can construct reject domain and the accept domain to test the hypothesis.</p>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="exercise-7.1" class="section level2">
<h2>Exercise 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>The leave_one-out jackknife estimate of bias is: <span class="math inline">\(\widehat{bias_{jack}} = (n - 1)(\overline{\hat{\theta}}_{(.)} - \hat{\theta})\)</span></p>
<p>The standard error is:<span class="math inline">\(\widehat{se_{jack}} = \sqrt{\frac{n - 1}{n}\sum\limits_{i = 1} ^{n}(\hat{\theta}_{i} - \overline{\hat{\theta}}_{(.)})^{2}}\)</span></p>
<p>In this way, we can compute the jackknife estimate bias of the correlation statistic is: -0.006473623, and standard error of the correlation statistic is: 0.1425186. The process is as follows.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">library</span>(bootstrap)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">data</span>(<span class="st">&quot;law&quot;</span>)</a>
<a class="sourceLine" id="cb56-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law) <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb56-3" title="3">cor_law &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb56-4" title="4"><span class="co"># Set up the jackknife</span></a>
<a class="sourceLine" id="cb56-5" title="5">cor_law_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb56-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb56-7" title="7">  cor_law_jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i], law<span class="op">$</span>GPA[<span class="op">-</span>i])</a>
<a class="sourceLine" id="cb56-8" title="8">}</a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co"># Estimate the bias</span></a>
<a class="sourceLine" id="cb56-10" title="10">bias_cor_law &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(cor_law_jack) <span class="op">-</span><span class="st"> </span>cor_law)</a>
<a class="sourceLine" id="cb56-11" title="11"><span class="kw">cat</span>(<span class="st">&#39;Jackknife estimate of the bias of the correlation statistic is:&#39;</span>, bias_cor_law,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## Jackknife estimate of the bias of the correlation statistic is: -0.006473623</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># Estimate the standard error</span></a>
<a class="sourceLine" id="cb58-2" title="2">se_cor_law &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((cor_law_jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(cor_law_jack))<span class="op">^</span>{<span class="dv">2</span>}))</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="kw">cat</span>(<span class="st">&#39;Jackknife estimate of the standard error of the correlation statistic is:&#39;</span>, se_cor_law, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## Jackknife estimate of the standard error of the correlation statistic is: 0.1425186</code></pre>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>From the Exercise 7.4, we can compute the <span class="math inline">\(MLE\)</span> of <span class="math inline">\(1/\lambda\)</span> is <span class="math inline">\(\overline{X} = 108.0833\)</span>.</p>
<p>Then we can obtain the 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span>:</p>
<p>by standard normal: (31.0, 182.1)</p>
<p>by basic：( 22.5, 168.8 )</p>
<p>by percentile: ( 47.4, 193.6 )</p>
<p>by BCa methods: ( 56.9, 230.5 )</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="kw">data</span>(<span class="st">&quot;aircondit&quot;</span>)</a>
<a class="sourceLine" id="cb60-4" title="4">B &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co"># number of replicates</span></a>
<a class="sourceLine" id="cb60-5" title="5">func &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){</a>
<a class="sourceLine" id="cb60-6" title="6">  y &lt;-<span class="st"> </span>x[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb60-7" title="7">  <span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb60-8" title="8">}</a>
<a class="sourceLine" id="cb60-9" title="9">boot_obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> aircondit, <span class="dt">statistic =</span> func, <span class="dt">R =</span> B)</a>
<a class="sourceLine" id="cb60-10" title="10"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original =</span> boot_obj<span class="op">$</span>t0, <span class="dt">bias =</span> <span class="kw">mean</span>(boot_obj<span class="op">$</span>t) <span class="op">-</span><span class="st"> </span>boot_obj<span class="op">$</span>t0, <span class="dt">se =</span> <span class="kw">sd</span>(boot_obj<span class="op">$</span>t)), <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## original     bias       se 
##  108.083   -0.760   36.660</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">boot_ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot_obj, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">print</span>(boot_ci)</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 500 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_obj, conf = 0.95, type = c(&quot;norm&quot;, &quot;basic&quot;, 
##     &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 37.0, 180.7 )   ( 28.5, 171.3 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.8, 187.7 )   ( 57.1, 228.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">mean</span>(aircondit[,<span class="dv">1</span>])</a></code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
<p>Then we need compare the intervals and explain why they may differ. From the results of running the code, all intervals cover the the <span class="math inline">\(\overline{X} = 108.0833\)</span>. The reason why these confidence intervals differ may partly caused by the limits of methods that intervals are estimated. For instance, the standard normal methods needs a large size of samples to assume that the Central Limit Theorem is sensible. While the percentile bootstrap method regard the <span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1−\alpha/2\)</span> quantiles of bootstrap replicates of the statistic <span class="math inline">\(\hat{\theta}\)</span> as the confidence interval upper bound and lower bound. Because the starting point and method of estimation are different, the intervals will nuturally be different.</p>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>The jackknife estimates of bias of <span class="math inline">\(\hat{\theta}\)</span> is: 0.001069139, and standard error of <span class="math inline">\(\hat{\theta}\)</span> is: 0.049552307. The process is as follows.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">data</span>(<span class="st">&quot;scor&quot;</span>)</a>
<a class="sourceLine" id="cb66-4" title="4">lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb66-5" title="5">theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</a>
<a class="sourceLine" id="cb66-6" title="6">B &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb66-7" title="7">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb66-8" title="8"><span class="co"># Estimate by jackknife</span></a>
<a class="sourceLine" id="cb66-9" title="9">theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb66-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb66-11" title="11">  x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb66-12" title="12">  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb66-13" title="13">  theta_jack[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb66-14" title="14">}</a>
<a class="sourceLine" id="cb66-15" title="15"> bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_jack) <span class="op">-</span><span class="st"> </span>theta_hat)</a>
<a class="sourceLine" id="cb66-16" title="16"> se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(theta_jack)</a>
<a class="sourceLine" id="cb66-17" title="17"><span class="kw">print</span>(<span class="kw">c</span>(bias_jack, se_jack))</a></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
<div id="exercise-7.11" class="section level2">
<h2>Exercise 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb75-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb75-3" title="3">L1 &lt;-<span class="st">  </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb75-4" title="4">L2 &lt;-<span class="st">  </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb75-5" title="5">L3 &lt;-<span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb75-6" title="6">L4 &lt;-<span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</a>
<a class="sourceLine" id="cb75-7" title="7">n &lt;-<span class="st"> </span><span class="kw">length</span>(ironslag<span class="op">$</span>magnetic) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb75-8" title="8">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-9" title="9"><span class="co">##leave-two-out</span></a>
<a class="sourceLine" id="cb75-10" title="10">m &lt;-<span class="st"> </span><span class="cf">for</span> (k <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n)<span class="op">*</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb75-11" title="11">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(k<span class="dv">-1</span>,k)] </a>
<a class="sourceLine" id="cb75-12" title="12">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(k<span class="dv">-1</span>,k)]</a>
<a class="sourceLine" id="cb75-13" title="13">  </a>
<a class="sourceLine" id="cb75-14" title="14">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb75-15" title="15">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb75-16" title="16">  e1[k<span class="dv">-1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="dv">-1</span>] <span class="op">-</span><span class="st"> </span>yhat1<span class="co">#error between estimation and observation of model</span></a>
<a class="sourceLine" id="cb75-17" title="17">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb75-18" title="18">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-19" title="19">  </a>
<a class="sourceLine" id="cb75-20" title="20">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb75-21" title="21">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="dv">-1</span>]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb75-22" title="22">  e2[k<span class="dv">-1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="dv">-1</span>] <span class="op">-</span><span class="st"> </span>yhat2<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-23" title="23">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb75-24" title="24">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-25" title="25"></a>
<a class="sourceLine" id="cb75-26" title="26">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb75-27" title="27">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="dv">-1</span>] </a>
<a class="sourceLine" id="cb75-28" title="28">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb75-29" title="29">  e3[k<span class="dv">-1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="dv">-1</span>] <span class="op">-</span><span class="st"> </span>yhat3<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-30" title="30">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb75-31" title="31">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb75-32" title="32">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-33" title="33">  </a>
<a class="sourceLine" id="cb75-34" title="34">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x)) </a>
<a class="sourceLine" id="cb75-35" title="35">  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k<span class="dv">-1</span>]) </a>
<a class="sourceLine" id="cb75-36" title="36">  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb75-37" title="37">  e4[k<span class="dv">-1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="dv">-1</span>] <span class="op">-</span><span class="st"> </span>yhat4<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-38" title="38">  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k]) </a>
<a class="sourceLine" id="cb75-39" title="39">  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb75-40" title="40">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4<span class="co">#error between estimation and observation</span></a>
<a class="sourceLine" id="cb75-41" title="41">}</a>
<a class="sourceLine" id="cb75-42" title="42"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1 <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="kw">mean</span>(e2 <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="kw">mean</span>(e3 <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="kw">mean</span>(e4 <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] 18.89909 17.02304 17.37150 19.43978</code></pre>
<p>Using the second model has the least average error：17.02304. So the second model is the best with the leave-two-out CV.</p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>From the references bibliography [193]. We need to adjust the test criterion for unequal sample sizes. Then we test the unequal sample size, the resluts 0.034 show that the adjust is reasonable. The process is as follows.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb77-2" title="2">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb77-3" title="3">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb77-4" title="4">sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb77-5" title="5">sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb77-6" title="6">cout5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</a>
<a class="sourceLine" id="cb77-7" title="7">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb77-8" title="8">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb77-9" title="9">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb77-10" title="10">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb77-11" title="11">  <span class="co"># return 1 (reject) or 0 (do notreject H0)</span></a>
<a class="sourceLine" id="cb77-12" title="12">  <span class="kw">return</span>(<span class="kw">as.integer</span>((outx <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)<span class="op">||</span><span class="st"> </span>(outy<span class="op">&gt;</span><span class="dv">7</span>)))</a>
<a class="sourceLine" id="cb77-13" title="13">}</a>
<a class="sourceLine" id="cb77-14" title="14">R &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb77-15" title="15">N &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb77-16" title="16">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, <span class="dt">sd =</span> sigma1)</a>
<a class="sourceLine" id="cb77-17" title="17">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="dt">sd =</span> sigma2)</a>
<a class="sourceLine" id="cb77-18" title="18">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb77-19" title="19">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb77-20" title="20">n_min &lt;-<span class="st"> </span><span class="kw">min</span>(n1, n2)</a>
<a class="sourceLine" id="cb77-21" title="21">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb77-22" title="22"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb77-23" title="23">  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n_min, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb77-24" title="24">  x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb77-25" title="25">  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb77-26" title="26">  reps[i] &lt;-<span class="st"> </span><span class="kw">cout5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb77-27" title="27">}</a>
<a class="sourceLine" id="cb77-28" title="28"><span class="kw">mean</span>(reps)</a></code></pre></div>
<pre><code>## [1] 0.034</code></pre>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nnenergy-and-ball-methods-in-various-situations." class="section level2">
<h2>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</h2>
<ol style="list-style-type: decimal">
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ol>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>In the next several graph, red line represents NN, green line represents energy and blue lines represents ball.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">library</span>(RANN)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">library</span>(energy)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">library</span>(Ball)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb85-2" title="2">nn.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</a>
<a class="sourceLine" id="cb85-3" title="3">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb85-4" title="4">o &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(z))</a>
<a class="sourceLine" id="cb85-5" title="5">z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(z, o))</a>
<a class="sourceLine" id="cb85-6" title="6">Tn3 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes) {</a>
<a class="sourceLine" id="cb85-7" title="7">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb85-8" title="8">  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb85-9" title="9">  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb85-10" title="10">  z &lt;-<span class="st"> </span>z[ix, ]</a>
<a class="sourceLine" id="cb85-11" title="11">  o &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(z))</a>
<a class="sourceLine" id="cb85-12" title="12">  z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(z, o))</a>
<a class="sourceLine" id="cb85-13" title="13">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(z, <span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-14" title="14">  b1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1, ]</a>
<a class="sourceLine" id="cb85-15" title="15">  b2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n, ]</a>
<a class="sourceLine" id="cb85-16" title="16">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(b1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb85-17" title="17">  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(b2 <span class="op">&gt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb85-18" title="18">  <span class="kw">return</span>((i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n))</a>
<a class="sourceLine" id="cb85-19" title="19">}</a>
<a class="sourceLine" id="cb85-20" title="20">N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</a>
<a class="sourceLine" id="cb85-21" title="21">boot_obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</a>
<a class="sourceLine" id="cb85-22" title="22">t_b &lt;-<span class="st"> </span><span class="kw">c</span>(boot_obj<span class="op">$</span>t, boot_obj<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb85-23" title="23"><span class="kw">mean</span>(t_b <span class="op">&gt;=</span><span class="st"> </span>boot_obj<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb85-24" title="24">}</a>
<a class="sourceLine" id="cb85-25" title="25">N0 &lt;-<span class="st"> </span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb85-26" title="26">energy.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">R=</span> N0){</a>
<a class="sourceLine" id="cb85-27" title="27">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb85-28" title="28">  o &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(z))</a>
<a class="sourceLine" id="cb85-29" title="29">  z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(z, o))</a>
<a class="sourceLine" id="cb85-30" title="30">  N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))</a>
<a class="sourceLine" id="cb85-31" title="31">  <span class="kw">eqdist.etest</span>(z, <span class="dt">sizes =</span> N, <span class="dt">R=</span>R)<span class="op">$</span>p</a>
<a class="sourceLine" id="cb85-32" title="32">}</a>
<a class="sourceLine" id="cb85-33" title="33"></a>
<a class="sourceLine" id="cb85-34" title="34"><span class="co">#1. Unequal variances and equal expectations</span></a>
<a class="sourceLine" id="cb85-35" title="35">matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-36" title="36"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb85-37" title="37">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb85-38" title="38">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>i<span class="op">/</span><span class="dv">10</span>)<span class="co"># yi = (1 + i/10)x</span></a>
<a class="sourceLine" id="cb85-39" title="39">  matrix[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nn.test</span>(x,y),<span class="kw">energy.test</span>(x,y),<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb85-40" title="40">}</a>
<a class="sourceLine" id="cb85-41" title="41"><span class="kw">plot</span>(matrix[,<span class="dv">1</span>], <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="dt">main =</span> <span class="st">&quot;unequal variance&quot;</span>)</a>
<a class="sourceLine" id="cb85-42" title="42"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i], <span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb85-43" title="43"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i], <span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co">#2. Unequal variances and unequal expectations</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb86-3" title="3">matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb86-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb86-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean =</span> i<span class="op">/</span><span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb86-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean =</span> i<span class="op">/</span><span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>i<span class="op">/</span><span class="dv">10</span>)<span class="co"># y, x unequal</span></a>
<a class="sourceLine" id="cb86-7" title="7">  matrix[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nn.test</span>(x,y),<span class="kw">energy.test</span>(x,y),<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb86-8" title="8">}</a>
<a class="sourceLine" id="cb86-9" title="9"><span class="kw">plot</span>(matrix[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>),<span class="dt">main=</span><span class="st">&quot;unequal variances and unequal expectations&quot;</span>)</a>
<a class="sourceLine" id="cb86-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb86-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co">#3_1 Non-normal distributions: t distribution with 1 df (heavy-tailed distribution)</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb87-3" title="3">matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb87-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rt</span>(<span class="dv">1000</span>,<span class="dt">df=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb87-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">rt</span>(<span class="dv">1000</span>,<span class="dt">df=</span><span class="dv">1</span><span class="op">+</span>i<span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb87-7" title="7">  matrix[i,]=<span class="kw">c</span>(<span class="kw">nn.test</span>(x,y),<span class="kw">energy.test</span>(x,y),<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb87-8" title="8">}</a>
<a class="sourceLine" id="cb87-9" title="9"><span class="kw">plot</span>(matrix[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>),<span class="dt">main=</span><span class="st">&quot;heavy-tail&quot;</span>)</a>
<a class="sourceLine" id="cb87-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb87-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co">#3_2 bimodel distribution (mixture of two normal distributions)</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb88-3" title="3">matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb88-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb88-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>)</a>
<a class="sourceLine" id="cb88-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">runif</span>(<span class="dv">500</span>)<span class="op">&lt;</span>i<span class="op">/</span><span class="dv">11</span>,<span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dt">sd=</span><span class="fl">0.3</span>),<span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dt">sd=</span><span class="fl">1.38</span>))</a>
<a class="sourceLine" id="cb88-7" title="7">  matrix[i,]=<span class="kw">c</span>(<span class="kw">nn.test</span>(x,y),<span class="kw">energy.test</span>(x,y),<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb88-8" title="8">}</a>
<a class="sourceLine" id="cb88-9" title="9"><span class="kw">plot</span>(matrix[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">main=</span><span class="st">&quot;bimodel&quot;</span>)</a>
<a class="sourceLine" id="cb88-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaoil+YrAAArACsrAFUrKwArVYArVaorgNRVAABVACtVKytVK4BVVVVVgKpVgNRVqqpVqtRVqv9h0E+AKwCAK1WAVQCAVSuAgFWAqtSA1P+qVQCqVSuqgCuq1Kqq1P+q/6qq///UgCvUgFXUqlXUqoDU1P/U/9TU///fU2v/qlX/1ID/1Kr//6r//9T////WOogyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJWUlEQVR4nO2dC3ebNhiGSdoYb93i7to4u8Xd2rB1C6Qx//+vDV3A2IBecZFQ4X3OsY+DZQmeiA90AaKcGInmXoHQoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBzCzpE14/64/E+unnq+6N+PxwABQECEjT4R0sX9Nd3UfTNB72dL7to8+lNdPUu/3sbvX6QaT4VCV79KBUc3xdL/1CCju+j6Orbp8ULUhRbXApSvNFL8zxRC26Uiiq5Tvn6cfGCbj7k/0TR5iToVvwdvRNmbvP8eSs2X33OinRPouYUgopq9EF8ebt0QVcPuYoqpaBiY9W73Poy4By0lOJz8e31Y/FWfFmI0z90tYLzC9K70dVDFYOkgk1+Xj10ik35o+JLhf6hqxWcX1B981sEqY9y77orPwtBWbQWQf1qkPysa9CdzmPhguR21mPQuSBDDNroPJYu6PriKHYhqHkUO+ijWHGy9FlE86ULujwPuhBUPw+qJ9fnQcVBcOGCmmfSF4LUmfRPMvnxz2306p3a0z7/tq390NUKzi0oeCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEmFhQ9MUwl6Bps3MHBQEoCOBZUP9de25YgwAUBKAgAAUBKAhAQQAKAlAQgIIAFARwKuh5e9f11boFVRf9R1HXDSXWLSjP1AVurEGdvOzEpX0UZOBw9UBBRpLoloKMPG9fUZCR4320OkH1A3j3MXzKcuemt6B6nciwoGRl50G9BV3mwk77ebJzBwUBHAkqb7LWuQ8uVZBFM1SQqLZY1SgbUe7c9K1Bx3uLwHy8r7QkHbdbWaygYuM3xnSC2rGu60C3XEHFXtN5elyy6hpkRVJKXF8MsqQM5p03fFq7IN/ZuYOCABQEoCAABQGGC0rkvRudlzs3rEEACgJ47lHsX+7cUBCAoxoAzrQH9Bd0/NdruXPTX9DLTvWYHX8ZvH/1KXduBuximTxBTEYEoD7lzs2QGKSGLDp6wqYud24GBWlhCPa7TlTu3AwRdIiid2PvDr9gQfpZORljUEfCl+9V1eFRbGDCWbJzhyNB4hkgMoyvb37QbdUcM43NF2dK6oRybYLsUCOrx3vxqJ31CaqNK3dRdoocbp5WKOi8S6iVyuFhs0JBfaZuygd8jSt3bgadKOLesnL2Qud0ogUL8lzu3AyoQW/VaNiIDuk+5c7NcEFd4fec1QXpw6lXeUiH0Br6pMsa5KncuWGQBgwQVB7nTTFotRPJBaIBsTFdbrnqieSyQZ9nohna3ee67mnAoi32/PWjfHXgdCL5fr8f/NsBDGvNiyOZQZDLGrTXL18MiEHi3O9wa9rFHE4k39fevTBo2GdjaKYrhk4kT9PUvBp7uYcFLshdual+nTiLOMpOoWetgtLau6KKOHstR/zlNUo7OlEcVm4q9zGFXKAjTls18sWQo9gUjyTvEHTax0pRbT7CFmTRJz203PQyBolok7b4CDoGWYxqDCw3bR7FRO1pO675MzQgBj1/NUF/R0u5rSLiOG77ImxBWydBut1P8RbnLSdH3gwN2cXwVb0Dyu30IwzVvxV1KmhBToJ0+wm0EBTH0kj1faxfvgyFEaTb2xf7woTyEZfkVZ3yZchzkG7vtO/yc6ovZSJdn4IWZDWy2qvcjvbpXteds2S6RunvPRBAW8zk54yaIZ3AA7MKEqeFXf0bTT+nvcynoTkFNTs3TrT5qR3s/BmaUZDy01mBWvyoH0hL3qLQvIJS0xG+nbLa+TI0cw3qEGTy49lQmDHIWIHS2vFs2YI6u+i7/SipaSXIvSFHgkaNzRv8NAx9oYLGjc3vDX5KO94MOZxILhkwsmr2U1Id7B0bciLIdmy+2R9fnCbb+cmVorhtlKOZ7Ygkc9ag5jB7bFt/FIWiOG+MtDazbSzpkcRVDLIYm9/LZlV9rWpNdUukofNcmtk2lvRJ4ugoZjM2v4/VeGlFrbPHmjS9zGU68tidIJvsys7Btu5Ce+K01qmmFhRvaT2TWB75YsMCQ5I5Be3LDsLaavX1U+XiABkPXQsyTCSX+8aFj3NfNtRzSS9pJmlfYEjiuQad9UkPqC8tXOaidrnzAf5hyFxmbYv1ry9tXOaSFgvO2nhpfjE+21hgSBJAn/TkNNrAjW6DZj9CZ5IQG6vT01TW6EfoShJiYzUoZmtqfDG4EGTRWB1RDE4ySSZ9K/nENWhEMQsQZNFYHVHMEgThxuqIYhYhaDAUNL4YChqdhIJ8ZEJBEyQZkXx9UBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIAHQXK0EfdhH8z9uOKSWnDRaHUz58481J1tsj5PCHMv6HhfrE2CNq5Ya6Mgce+n8tEfHYibORufFvuyk4NVmUhnbci9IHXTL3R7xpedUZAacTJmoq5KPnQ7zNSQucrKkO4cXzEI/cuSm19NgiyuF0WCsuhWDnfa/cMqfAk6mFeoEGCMQdn1xx0KZHAXU+PByrX10LAnQWCkUVR7oyD5RB10aT8MvtKKqsvWQciPoAzEaDGSbRZ0hf/topI+b03/iGAFoZFqWevNgqQa400eLWJLqLtYgs6CEj0lpXvz1fYYQ7VFzQg0SCd2T1Qy1iA188b4b1cbbkySBXmYN4eFE+YzaRGlwN0zLGNQcCeKev+BawSaGhlurxxQEl29ej2MmI1VAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQnqDGvAL7iQYuoCAABQGCFPSy+3mn5puJmSq/C0GJmtoiJoaJZwr7I1BBYnJ+8RJzorJI/yEmR4k5VH3vXTSOQAXdyil1albdQS+Q85+y649vve5xgQq6k9MSqylzKgxJXwd41ce0BC0oqQSdpsGa59JPT9CCLmqQ4Hj/w6jHV/UmaEF6SrNeIElu/pvkSXHWBC1IX5+ij2IqWt/1vkXhOMIWdH4eJJ73LqdL+wzT4QkKDAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/+rtI64VDa6AAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#4 Unbalanced samples (say, 1 case versus 10 controls)</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb89-3" title="3">matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb89-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">/</span>i)</a>
<a class="sourceLine" id="cb89-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span>i,<span class="dt">sd=</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb89-7" title="7">  matrix[i,]=<span class="kw">c</span>(<span class="kw">nn.test</span>(x,y),<span class="kw">energy.test</span>(x,y),<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb89-8" title="8">}</a>
<a class="sourceLine" id="cb89-9" title="9"><span class="kw">plot</span>(matrix[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;unbalanced&quot;</span>)</a>
<a class="sourceLine" id="cb89-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb89-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)<span class="kw">points</span>(matrix[,i],<span class="dt">col=</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace pdf is:<span class="math display">\[\begin{align}
f(x) = \frac{1}{2}e^{-|x|}, x  \in R
\end{align}\]</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb90-2" title="2">dl &lt;-<span class="st"> </span><span class="cf">function</span>(x){ <span class="co">#Laplace function</span></a>
<a class="sourceLine" id="cb90-3" title="3">        <span class="kw">return</span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb90-4" title="4">} </a>
<a class="sourceLine" id="cb90-5" title="5">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb90-6" title="6">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb90-7" title="7">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb90-8" title="8">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb90-9" title="9">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb90-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb90-11" title="11">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb90-12" title="12"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">dl</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dl</span>(x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb90-13" title="13">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb90-14" title="14">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb90-15" title="15">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb90-16" title="16">} }</a>
<a class="sourceLine" id="cb90-17" title="17"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb90-18" title="18">}</a>
<a class="sourceLine" id="cb90-19" title="19">n &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#degrees of freedom for target Student t dist.</span></a>
<a class="sourceLine" id="cb90-20" title="20">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb90-21" title="21">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb90-22" title="22">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb90-23" title="23">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb90-24" title="24">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb90-25" title="25">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb90-26" title="26">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb90-27" title="27"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb90-28" title="28"><span class="kw">print</span>(<span class="kw">c</span>((N <span class="op">-</span><span class="st"> </span>rw1<span class="op">$</span>k) <span class="op">/</span><span class="st"> </span>N, (N <span class="op">-</span><span class="st"> </span>rw2<span class="op">$</span>k) <span class="op">/</span><span class="st"> </span>N, (N <span class="op">-</span><span class="st"> </span>rw3<span class="op">$</span>k) <span class="op">/</span><span class="st"> </span>N, (N <span class="op">-</span><span class="st"> </span>rw4<span class="op">$</span>k) <span class="op">/</span><span class="st"> </span>N))</a></code></pre></div>
<pre><code>## [1] 0.9810 0.8365 0.5005 0.1875</code></pre>
<p>From the result, we can see when <span class="math inline">\(\sigma = (0.05, 0.5, 2, 8)\)</span>, the acceptance rates of each chain are<span class="math inline">\((0.9810, 0.8365, 0.5005, 0.1875)\)</span>.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt; 1.2\)</span>.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>The Gelman-Rubin statistic is the estimated potential scale reduction<span class="math inline">\(\sqrt{\hat{R}} = \sqrt{\frac{\hat{Var}(\psi)}{W}}\)</span> .which can be interpreted as measuring the factor by which the standard deviation of<span class="math inline">\(\psi\)</span> could be reduced by extending the chain. The function named ‘Gelman.Rubin’ is defined firstly to compute the diagnostic statistics after all chains have been generated. In this question, We chose<span class="math inline">\(\sigma = 2\)</span>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb92-2" title="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#parameter of distribution</span></a>
<a class="sourceLine" id="cb92-3" title="3">k &lt;-<span class="st"> </span><span class="dv">4</span><span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb92-4" title="4">N &lt;-<span class="st"> </span><span class="dv">15000</span><span class="co">#length of the chain</span></a>
<a class="sourceLine" id="cb92-5" title="5">b &lt;-<span class="st"> </span><span class="dv">500</span><span class="co">#burn-in</span></a>
<a class="sourceLine" id="cb92-6" title="6"></a>
<a class="sourceLine" id="cb92-7" title="7">dl&lt;-<span class="cf">function</span>(x){<span class="co">#Laplace function</span></a>
<a class="sourceLine" id="cb92-8" title="8">  <span class="kw">return</span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb92-9" title="9">}</a>
<a class="sourceLine" id="cb92-10" title="10"></a>
<a class="sourceLine" id="cb92-11" title="11">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb92-12" title="12">  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb92-13" title="13">  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb92-14" title="14">  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb92-15" title="15">  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)<span class="co">#row means</span></a>
<a class="sourceLine" id="cb92-16" title="16">  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)<span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb92-17" title="17">  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)<span class="co">#within variances</span></a>
<a class="sourceLine" id="cb92-18" title="18">  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)<span class="co">#within est.</span></a>
<a class="sourceLine" id="cb92-19" title="19">  v.hat &lt;-<span class="st"> </span>W <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>n <span class="op">+</span><span class="st"> </span>(B <span class="op">/</span><span class="st"> </span>n)<span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb92-20" title="20">  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W<span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb92-21" title="21">  <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb92-22" title="22">}</a>
<a class="sourceLine" id="cb92-23" title="23"></a>
<a class="sourceLine" id="cb92-24" title="24">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb92-25" title="25">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb92-26" title="26">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb92-27" title="27">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb92-28" title="28">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb92-29" title="29">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb92-30" title="30">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb92-31" title="31">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dl</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dl</span>(x[i<span class="dv">-1</span>]))){</a>
<a class="sourceLine" id="cb92-32" title="32">      x[i] &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb92-33" title="33">    }</a>
<a class="sourceLine" id="cb92-34" title="34">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb92-35" title="35">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb92-36" title="36">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb92-37" title="37">      } </a>
<a class="sourceLine" id="cb92-38" title="38">    }</a>
<a class="sourceLine" id="cb92-39" title="39">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb92-40" title="40">}</a>
<a class="sourceLine" id="cb92-41" title="41"></a>
<a class="sourceLine" id="cb92-42" title="42"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb92-43" title="43">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb92-44" title="44">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</a>
<a class="sourceLine" id="cb92-45" title="45"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb92-46" title="46">  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[i], N)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb92-47" title="47"></a>
<a class="sourceLine" id="cb92-48" title="48"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb92-49" title="49">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb92-50" title="50"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) </a>
<a class="sourceLine" id="cb92-51" title="51">  psi[i, ] &lt;-<span class="st"> </span>psi[i, ] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb92-52" title="52"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</a></code></pre></div>
<pre><code>## [1] 1.08346</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb94-4" title="4">  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="co"># plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb95-4" title="4">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</a>
<a class="sourceLine" id="cb95-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N) </a>
<a class="sourceLine" id="cb95-6" title="6">  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb95-7" title="7"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb95-8" title="8"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-11.4" class="section level2">
<h2>Exercises 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves<span class="math display">\[\begin{align}
 S_{k - 1}(a) = P(t(k - 1) &gt; \sqrt{\frac{a^{2}(k - 1)}{k - a^{2}}})
 \end{align}\]</span> and <span class="math display">\[\begin{align}
 S_{k}(a) = P(t(k) &gt; \sqrt{\frac{a^{2}k}{k + 1 - a^{2}}})
 \end{align}\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>Firstly, we define a function S with parameters <span class="math inline">\(k\)</span> and a to generate the curve <span class="math inline">\(S_{k}(a) - S_{k - 1}(a)\)</span>. If we can compute the intersection points of the curves <span class="math inline">\(S_{k}(a)\)</span> and <span class="math inline">\(S_{k - 1}(a)\)</span> by computing the root of function <span class="math inline">\(S_{k}(a) - S_{k - 1}(a)\)</span>.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb96-2" title="2">eps &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span><span class="co">#judge whether function is near to 0</span></a>
<a class="sourceLine" id="cb96-3" title="3">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)<span class="co">#k mentioned in the question</span></a>
<a class="sourceLine" id="cb96-4" title="4"></a>
<a class="sourceLine" id="cb96-5" title="5">S &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb96-6" title="6">  <span class="kw">return</span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k) <span class="op">/</span><span class="st"> </span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k)) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)) <span class="op">/</span><span class="st"> </span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k<span class="dv">-1</span>)))</a>
<a class="sourceLine" id="cb96-7" title="7">}<span class="co">#function of S_k(a) - S_{k-1}(a)</span></a>
<a class="sourceLine" id="cb96-8" title="8">Root &lt;-<span class="st"> </span><span class="cf">function</span>(k1){</a>
<a class="sourceLine" id="cb96-9" title="9">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="kw">sqrt</span>(k1) <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>,<span class="dt">length =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb96-10" title="10">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">S</span>(k1,a[<span class="dv">1</span>]), <span class="kw">S</span>(k1,a[<span class="dv">2</span>]), <span class="kw">S</span>(k1,a[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb96-11" title="11"><span class="cf">while</span>(<span class="kw">abs</span>(y[<span class="dv">2</span>]) <span class="op">&gt;</span><span class="st"> </span>eps) {</a>
<a class="sourceLine" id="cb96-12" title="12">  <span class="cf">if</span> (y[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>y[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb96-13" title="13">    a[<span class="dv">3</span>] &lt;-<span class="st"> </span>a[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb96-14" title="14">    y[<span class="dv">3</span>] &lt;-<span class="st"> </span>y[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb96-15" title="15">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb96-16" title="16">    a[<span class="dv">1</span>] &lt;-<span class="st"> </span>a[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb96-17" title="17">    y[<span class="dv">1</span>] &lt;-<span class="st"> </span>y[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb96-18" title="18">  }</a>
<a class="sourceLine" id="cb96-19" title="19">  a[<span class="dv">2</span>] &lt;-<span class="st"> </span>(a[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>a[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb96-20" title="20">  y[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">S</span>(k1,a[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb96-21" title="21">}</a>
<a class="sourceLine" id="cb96-22" title="22">result &lt;-<span class="kw">list</span>(k1,a[<span class="dv">2</span>],y[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb96-23" title="23"><span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb96-24" title="24">}</a>
<a class="sourceLine" id="cb96-25" title="25"></a>
<a class="sourceLine" id="cb96-26" title="26"><span class="cf">for</span>(i <span class="cf">in</span> k){<span class="co">#print the output of each k</span></a>
<a class="sourceLine" id="cb96-27" title="27">  <span class="kw">cat</span>(<span class="st">&#39;k:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">1</span>]],<span class="st">&#39;root:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">2</span>]],<span class="st">&#39;value of function:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">3</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb96-28" title="28">  </a>
<a class="sourceLine" id="cb96-29" title="29">} </a></code></pre></div>
<pre><code>## k: 4 root: 1.492188 value of function: 2.19293e-06 
## k: 5 root: 1.53161 value of function: -2.600727e-05 
## k: 6 root: 1.576228 value of function: 0.000107711 
## k: 7 root: 1.59038 value of function: 3.14324e-05 
## k: 8 root: 1.57849 value of function: -8.553791e-05 
## k: 9 root: 1.5875 value of function: -7.580885e-05 
## k: 10 root: 1.581139 value of function: -9.644197e-05 
## k: 11 root: 1.658312 value of function: 3.993887e-05 
## k: 12 root: 1.732051 value of function: 0.0001166009 
## k: 13 root: 1.589929 value of function: -6.878761e-05 
## k: 14 root: 1.649475 value of function: -4.503052e-06 
## k: 15 root: 1.70693 value of function: 3.769164e-05 
## k: 16 root: 1.525 value of function: -0.000104609 
## k: 17 root: 1.571165 value of function: -6.213979e-05 
## k: 18 root: 1.61599 value of function: -3.041938e-05 
## k: 19 root: 1.659587 value of function: -6.8282e-06 
## k: 20 root: 2.236068 value of function: 0.0001210204 
## k: 21 root: 2.291288 value of function: 0.0001079948 
## k: 22 root: 2.345208 value of function: 9.578466e-05 
## k: 23 root: 2.397916 value of function: 8.454769e-05 
## k: 24 root: 2.44949 value of function: 7.434282e-05 
## k: 25 root: 2.5 value of function: 6.516662e-05 
## k: 100 root: 5 value of function: 1.068744e-09 
## k: 500 root: 11.18034 value of function: 0 
## k: 1000 root: 15.81139 value of function: 0</code></pre>
<p>Next, plot two curves to show in two cases, the intersection points computed by the algorithm.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">k &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb98-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb98-3" title="3">y0 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</a>
<a class="sourceLine" id="cb98-4" title="4">y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k) <span class="op">/</span><span class="st"> </span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k)) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)) <span class="op">/</span><span class="st"> </span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb98-5" title="5"><span class="kw">plot</span>(a,y,<span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb98-6" title="6"><span class="kw">lines</span>(a,y0)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;The root of curves when k = &#39;</span>,k,<span class="st">&#39;is&#39;</span>,<span class="kw">Root</span>(k)[[<span class="dv">2</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## The root of curves when k =  4 is 1.492188</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">k &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb101-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="kw">sqrt</span>(k) <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>, <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb101-3" title="3">y0 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</a>
<a class="sourceLine" id="cb101-4" title="4">y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb101-5" title="5"><span class="kw">plot</span>(a,y,<span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb101-6" title="6"><span class="kw">lines</span>(a,y0)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;The root of curves when k = &#39;</span>,k,<span class="st">&#39;is&#39;</span>,<span class="kw">Root</span>(k)[[<span class="dv">2</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## The root of curves when k =  10 is 1.581139</code></pre>
<p>As the figures present, the intersection of the function value and zero is the numble computed exactly.</p>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<ul>
<li>Let the three alleles be A, B, and O.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">Frequency</th>
<th align="center">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">AA</td>
<td align="center">p2</td>
<td align="center">nAA</td>
</tr>
<tr class="even">
<td align="center">BB</td>
<td align="center">q2</td>
<td align="center">nBB</td>
</tr>
<tr class="odd">
<td align="center">OO</td>
<td align="center">r2</td>
<td align="center">nOO</td>
</tr>
<tr class="even">
<td align="center">AO</td>
<td align="center">2pr</td>
<td align="center">nAO</td>
</tr>
<tr class="odd">
<td align="center">BO</td>
<td align="center">2qr</td>
<td align="center">nBO</td>
</tr>
<tr class="even">
<td align="center">AB</td>
<td align="center">2pq</td>
<td align="center">nAB</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">1</td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<ul>
<li>Observed data: <span class="math inline">\(n_{A·}= n_{AA} + n_{AO} = 444\)</span> (A-type),<span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type), <span class="math inline">\(n_{AB} = 63\)</span> (AB-type).</li>
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</li>
<li>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ul>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>Suppose that<span class="math inline">\(\theta = (p^2,2pr,q^2,2qr,r^2,2pq)\)</span>. The complete data likelihood is: <span class="math display">\[\begin{equation*}
\begin{split}
L(\theta|n_{AA},n_{AO},n_{BB},n_{BO},n_{OO},n_{AB},\theta) 
&amp; = {(p^2)}^{n_{AA}}{(2pr)}^{n_{AO}}{(q^2)}^{n_{BB}}{(2qr)}^{n_{BO}}{(r^2)}^{n_{OO}}{(2pq)}^{n_{AB}}\frac{n!}{n_{AA}!n_{AO}!n_{BB}!n_{BO}!n_{OO}!n_{AB}!}.
\end{split}
\end{equation*}\]</span> And observed data: <span class="math inline">\(n_{A·}= n_{AA} + n_{AO} = 444\)</span> (A-type),<span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type), <span class="math inline">\(n_{AB} = 63\)</span> (AB-type). while missing data: <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>. Then in t-th step of EM algorithm, <span class="math display">\[n_{AA}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB}\sim B(n_{A\cdot},\frac{{(p^{(t)})}^2}{{(p^{(t)})}^2+2p^{(t)}r^{(t)}})\]</span></p>
<p><span class="math display">\[n_{AO}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB}\sim B(n_{A\cdot},\frac{2p^{(t)}r^{(t)}}{{(p^{(t)})}^2+2p^{(t)}r^{(t)}})\]</span></p>
<p><span class="math display">\[n_{BB}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB}\sim B(n_{B\cdot},\frac{{(q^{(t)})}^2}{{(q^{(t)})}^2+2q^{(t)}r^{(t)}})\]</span></p>
<p><span class="math display">\[n_{BO}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB}\sim B(n_{B\cdot},\frac{2q^{(t)}r^{(t)}}{{(q^{(t)})}^2+2q^{(t)}r^{(t)}})\]</span> Then, take E-step and M-step: <span class="math display">\[\begin{equation*}
\begin{split}
Q(\theta) 
 &amp; = N_{AA}^{(t)}ln(p^2)+N_{AO}^{(t)}ln(2pr)+N_{BB}^{(t)}ln(q^2)+N_{BO}^{(t)}ln(2qr)+N_{OO}^{(t)}ln(r^2)+N_{AB}^{(t)}ln(2pq)+k(n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})
\end{split}
\end{equation*}\]</span> Where <span class="math display">\[N_{AA}^{(t)}=E(n_{AA}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=n_{A\cdot}\cdot\frac{{(p^{(t)})}^2}{{(p^{(t)})}^2+2p^{(t)}r^{(t)}}\]</span> <span class="math display">\[N_{AO}^{(t)}=E(n_{AO}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=n_{A\cdot}\cdot\frac{2p^{(t)}r^{(t)}}{{(p^{(t)})}^2+2p^{(t)}r^{(t)}}\]</span> <span class="math display">\[N_{BB}^{(t)}=E(n_{BB}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=n_{B\cdot}\cdot\frac{{(q^{(t)})}^2}{{(q^{(t)})}^2+2q^{(t)}r^{(t)}}\]</span> <span class="math display">\[N_{BO}^{(t)}=E(n_{BO}^{(t)}|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=n_{B\cdot}\cdot\frac{2q^{(t)}r^{(t)}}{{(q^{(t)})}^2+2q^{(t)}r^{(t)}}\]</span> <span class="math display">\[N_{OO}^{(t)}=n_{OO},\ N_{AB}^{(t)}=n_{AB}\]</span> <span class="math display">\[k(n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=\frac{n!}{n_{AA}!n_{AO}!n_{BB}!n_{BO}!n_{OO}!n_{AB}!} \]</span> Notice that<span class="math inline">\(p+q+r=1\)</span>, then we have (t + 1) M-step： <span class="math display">\[p^{(t+1)}= \frac{2N_{AA}^{(t)}+N_{AO}^{(t)}+N_{AB}^{(t)}}{2n}\]</span> <span class="math display">\[q^{(t+1)}= \frac{2N_{BB}^{(t)}+N_{BO}^{(t)}+N_{AB}^{(t)}}{2n}\]</span> <span class="math display">\[r^{(t+1)}=\frac{2N_{OO}^{(t)}+N_{AO}^{(t)}+N_{BO}^{(t)}}{2n} \]</span> Therefore, we can use EM algorithm to solve MLE of<span class="math inline">\(p,q\)</span> from above formula：</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">EM &lt;-<span class="st"> </span><span class="cf">function</span>(p_ini,n.obs){</a>
<a class="sourceLine" id="cb104-2" title="2">  T &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps <span class="co"># converge time</span></a>
<a class="sourceLine" id="cb104-3" title="3">  M &lt;-<span class="st"> </span><span class="fl">1e3</span> <span class="co"># the maximum ieration number</span></a>
<a class="sourceLine" id="cb104-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">sum</span>(n.obs)</a>
<a class="sourceLine" id="cb104-5" title="5">  nA. &lt;-<span class="st"> </span>n.obs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb104-6" title="6">  nB. &lt;-<span class="st"> </span>n.obs[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb104-7" title="7">  nOO &lt;-<span class="st"> </span>n.obs[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb104-8" title="8">  nAB &lt;-<span class="st"> </span>n.obs[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb104-9" title="9">  <span class="co"># assignment</span></a>
<a class="sourceLine" id="cb104-10" title="10">  p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb104-11" title="11">  p[<span class="dv">1</span>] &lt;-<span class="st"> </span>p_ini[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb104-12" title="12">  q[<span class="dv">1</span>] &lt;-<span class="st"> </span>p_ini[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb104-13" title="13">  r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>q[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb104-14" title="14">  t &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb104-15" title="15">  <span class="co"># calculate</span></a>
<a class="sourceLine" id="cb104-16" title="16">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb104-17" title="17">    p_pre &lt;-<span class="st"> </span>p[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb104-18" title="18">    q_pre &lt;-<span class="st"> </span>q[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb104-19" title="19">    r_pre &lt;-<span class="st"> </span>r[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb104-20" title="20">    </a>
<a class="sourceLine" id="cb104-21" title="21">    nAA_t &lt;-<span class="st"> </span>nA.<span class="op">*</span>p_pre<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb104-22" title="22">    nAO_t &lt;-<span class="st"> </span>nA.<span class="op">*</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre<span class="op">/</span>(p_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb104-23" title="23">    nBB_t &lt;-<span class="st"> </span>nB.<span class="op">*</span>q_pre<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb104-24" title="24">    nBO_t &lt;-<span class="st"> </span>nB.<span class="op">*</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre<span class="op">/</span>(q_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb104-25" title="25">    nOO_t &lt;-<span class="st"> </span>nOO</a>
<a class="sourceLine" id="cb104-26" title="26">    nAB_t &lt;-<span class="st"> </span>nAB</a>
<a class="sourceLine" id="cb104-27" title="27">    </a>
<a class="sourceLine" id="cb104-28" title="28">    p[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nAA_t<span class="op">+</span>nAO_t<span class="op">+</span>nAB_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb104-29" title="29">    q[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nBB_t<span class="op">+</span>nBO_t<span class="op">+</span>nAB_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb104-30" title="30">    r[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nOO_t<span class="op">+</span>nAO_t<span class="op">+</span>nBO_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb104-31" title="31">    t &lt;-<span class="st"> </span>t<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb104-32" title="32">    </a>
<a class="sourceLine" id="cb104-33" title="33">    U &lt;-<span class="st"> </span><span class="kw">abs</span>((p[i]<span class="op">-</span>p_pre)<span class="op">/</span>p_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb104-34" title="34">    V &lt;-<span class="st"> </span><span class="kw">abs</span>((q[i]<span class="op">-</span>q_pre)<span class="op">/</span>q_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb104-35" title="35">    W &lt;-<span class="st"> </span><span class="kw">abs</span>((r[i]<span class="op">-</span>r_pre)<span class="op">/</span>r_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb104-36" title="36">    <span class="cf">if</span>(U<span class="op">&amp;&amp;</span>V<span class="op">&amp;&amp;</span>W)</a>
<a class="sourceLine" id="cb104-37" title="37">      <span class="cf">break</span></a>
<a class="sourceLine" id="cb104-38" title="38">  }</a>
<a class="sourceLine" id="cb104-39" title="39">  <span class="kw">list</span>(<span class="dt">p_mle.em=</span>p[t],<span class="dt">q.mle.em=</span>q[t],<span class="dt">r.mle.em=</span>r[t],<span class="dt">t=</span>t)</a>
<a class="sourceLine" id="cb104-40" title="40">}</a>
<a class="sourceLine" id="cb104-41" title="41">nObs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">444</span>,<span class="dv">132</span>,<span class="dv">361</span>,<span class="dv">63</span>)</a>
<a class="sourceLine" id="cb104-42" title="42">p_Initial &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="co">#initial p,q value</span></a>
<a class="sourceLine" id="cb104-43" title="43">em.result&lt;-<span class="kw">EM</span>(<span class="dt">p_ini=</span>p_Initial,<span class="dt">n.obs=</span>nObs)</a>
<a class="sourceLine" id="cb104-44" title="44"><span class="kw">print</span>(em.result)</a></code></pre></div>
<pre><code>## $p_mle.em
## [1] 0.2976407
## 
## $q.mle.em
## [1] 0.1027063
## 
## $r.mle.em
## [1] 0.5996531
## 
## $t
## [1] 23</code></pre>
<p>So, the MLE of p is  = 0.2976407, the MLE of q is  = 0.1027063</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<p>we can see the log-maximum likelihood values (for observed data), are increasing. And eventually converges to a stability constant. The process is as follows.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">EM_trend &lt;-<span class="st"> </span><span class="cf">function</span>(p_ini, n.obs){</a>
<a class="sourceLine" id="cb106-2" title="2">  T &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps <span class="co"># converge time</span></a>
<a class="sourceLine" id="cb106-3" title="3">  M &lt;-<span class="st"> </span><span class="fl">1e3</span> <span class="co"># the maximum ieration number</span></a>
<a class="sourceLine" id="cb106-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">sum</span>(n.obs)</a>
<a class="sourceLine" id="cb106-5" title="5">  nA. &lt;-<span class="st"> </span>n.obs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb106-6" title="6">  nB. &lt;-<span class="st"> </span>n.obs[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb106-7" title="7">  nOO &lt;-<span class="st"> </span>n.obs[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb106-8" title="8">  nAB &lt;-<span class="st"> </span>n.obs[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb106-9" title="9">  <span class="co"># assignment</span></a>
<a class="sourceLine" id="cb106-10" title="10">  p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb106-11" title="11">  loglikelihood &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb106-12" title="12">  p[<span class="dv">1</span>] &lt;-<span class="st"> </span>p_ini[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb106-13" title="13">  q[<span class="dv">1</span>] &lt;-<span class="st"> </span>p_ini[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb106-14" title="14">  r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>q[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb106-15" title="15">  loglikelihood[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb106-16" title="16">  t &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb106-17" title="17">  </a>
<a class="sourceLine" id="cb106-18" title="18">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb106-19" title="19">    p_pre &lt;-<span class="st"> </span>p[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb106-20" title="20">    q_pre &lt;-<span class="st"> </span>q[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb106-21" title="21">    r_pre &lt;-<span class="st"> </span>r[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb106-22" title="22">    </a>
<a class="sourceLine" id="cb106-23" title="23">    nAA_t &lt;-<span class="st"> </span>nA.<span class="op">*</span>p_pre<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb106-24" title="24">    nAO_t &lt;-<span class="st"> </span>nA.<span class="op">*</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre<span class="op">/</span>(p_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb106-25" title="25">    nBB_t &lt;-<span class="st"> </span>nB.<span class="op">*</span>q_pre<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb106-26" title="26">    nBO_t &lt;-<span class="st"> </span>nB.<span class="op">*</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre<span class="op">/</span>(q_pre<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q_pre<span class="op">*</span>r_pre)</a>
<a class="sourceLine" id="cb106-27" title="27">    nOO_t &lt;-<span class="st"> </span>nOO</a>
<a class="sourceLine" id="cb106-28" title="28">    nAB_t &lt;-<span class="st"> </span>nAB</a>
<a class="sourceLine" id="cb106-29" title="29">    </a>
<a class="sourceLine" id="cb106-30" title="30">    p[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nAA_t<span class="op">+</span>nAO_t<span class="op">+</span>nAB_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb106-31" title="31">    q[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nBB_t<span class="op">+</span>nBO_t<span class="op">+</span>nAB_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb106-32" title="32">    r[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nOO_t<span class="op">+</span>nAO_t<span class="op">+</span>nBO_t)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb106-33" title="33">    t &lt;-<span class="st"> </span>t<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb106-34" title="34">    </a>
<a class="sourceLine" id="cb106-35" title="35">    loglikelihood[i]=nAA_t<span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p[i])<span class="op">+</span>nAO_t<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>r[i])<span class="op">+</span>nBB_t<span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(q[i])<span class="op">+</span>nBO_t<span class="op">*</span><span class="kw">log</span>(q[i]<span class="op">*</span>r[i])<span class="op">+</span>nOO_t<span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(r[i])<span class="op">+</span>nAB_t<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>q[i])</a>
<a class="sourceLine" id="cb106-36" title="36">    </a>
<a class="sourceLine" id="cb106-37" title="37">    U &lt;-<span class="st"> </span><span class="kw">abs</span>((p[i]<span class="op">-</span>p_pre)<span class="op">/</span>p_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb106-38" title="38">    V &lt;-<span class="st"> </span><span class="kw">abs</span>((q[i]<span class="op">-</span>q_pre)<span class="op">/</span>q_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb106-39" title="39">    W &lt;-<span class="st"> </span><span class="kw">abs</span>((r[i]<span class="op">-</span>r_pre)<span class="op">/</span>r_pre)<span class="op">&lt;=</span>T</a>
<a class="sourceLine" id="cb106-40" title="40">    <span class="cf">if</span>(U<span class="op">&amp;&amp;</span>V<span class="op">&amp;&amp;</span>W)</a>
<a class="sourceLine" id="cb106-41" title="41">      <span class="cf">break</span></a>
<a class="sourceLine" id="cb106-42" title="42">  }</a>
<a class="sourceLine" id="cb106-43" title="43">  <span class="kw">list</span>(<span class="dt">p_mle.em=</span>p[t],<span class="dt">q.mle.em=</span>q[t],<span class="dt">r.mle.em=</span>r[t],<span class="dt">t=</span>t,<span class="dt">p_mle.all=</span>p,<span class="dt">q.mle.all=</span>q,<span class="dt">loglikelihoods=</span>loglikelihood)</a>
<a class="sourceLine" id="cb106-44" title="44">}</a>
<a class="sourceLine" id="cb106-45" title="45">nObs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">444</span>,<span class="dv">132</span>,<span class="dv">361</span>,<span class="dv">63</span>)</a>
<a class="sourceLine" id="cb106-46" title="46">pInitial &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.3</span>) <span class="co">#initial p,q value</span></a>
<a class="sourceLine" id="cb106-47" title="47">em.result &lt;-<span class="st"> </span><span class="kw">EM_trend</span>(<span class="dt">p_ini=</span>pInitial,<span class="dt">n.obs=</span>nObs)</a>
<a class="sourceLine" id="cb106-48" title="48"></a>
<a class="sourceLine" id="cb106-49" title="49"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb106-50" title="50"><span class="kw">plot</span>(em.result<span class="op">$</span>loglikelihoods[<span class="op">-</span><span class="dv">1</span>],<span class="dt">xlab =</span> <span class="st">&quot;t&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;loglikehood&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb107-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb107-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb107-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb107-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb107-6" title="6">)</a>
<a class="sourceLine" id="cb107-7" title="7"></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="co">##Use loops to fit </span></a>
<a class="sourceLine" id="cb107-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)) {</a>
<a class="sourceLine" id="cb107-10" title="10">  re &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], mtcars)</a>
<a class="sourceLine" id="cb107-11" title="11">  <span class="kw">print</span>(re)</a>
<a class="sourceLine" id="cb107-12" title="12">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">## lapply() to fit</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">data=</span>mtcars,x))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb111-3" title="3"><span class="co">##Use sapply</span></a>
<a class="sourceLine" id="cb111-4" title="4">p_value &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb111-5" title="5">p_value</a></code></pre></div>
<pre><code>##   [1] 0.94125682 0.03091324 0.13658475 0.69487989 0.89538786 0.70926964
##   [7] 0.95014630 0.86325926 0.17961874 0.77570503 0.74537827 0.04994255
##  [13] 0.23719352 0.55369224 0.42616389 0.87979334 0.12861202 0.53697466
##  [19] 0.30947058 0.37948350 0.91272540 0.07698488 0.09429994 0.61455260
##  [25] 0.64250877 0.07484334 0.49284662 0.21341879 0.14619949 0.04088672
##  [31] 0.69344447 0.62862048 0.12599306 0.09556730 0.37812542 0.74489037
##  [37] 0.08293305 0.13917392 0.87977049 0.40031313 0.99174953 0.27440572
##  [43] 0.48827005 1.00000000 0.46959414 0.35539850 0.05137128 0.63268940
##  [49] 0.79242659 0.80694936 0.07660221 0.76638994 0.50742420 0.97142029
##  [55] 0.52504796 0.68217314 0.10027628 0.69155192 0.47383513 0.43287953
##  [61] 0.86897698 0.79101134 0.85053996 0.79757091 0.37894407 0.07426456
##  [67] 0.90702514 0.85313948 0.28242408 0.83490242 0.31977481 0.91498685
##  [73] 0.45406672 0.39475184 0.79600169 0.09396281 0.35499849 0.88559377
##  [79] 0.06509089 0.10740743 0.61231325 0.61681507 0.88921731 0.92167189
##  [85] 0.76346338 0.42750196 0.33316232 0.11580836 0.86538553 0.67433434
##  [91] 0.43706398 0.62251773 0.96184916 0.38924939 0.02333258 0.36397976
##  [97] 0.88509328 0.50334453 0.81962155 0.74379175</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>The arguments should the function take are data, function and the output type.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">func &lt;-<span class="st"> </span><span class="cf">function</span>(data,funct,output_type){</a>
<a class="sourceLine" id="cb113-2" title="2">  new &lt;-<span class="st"> </span><span class="kw">Map</span>(funct,data)</a>
<a class="sourceLine" id="cb113-3" title="3">  <span class="kw">vapply</span>(new, <span class="cf">function</span>(x) x ,output_type)</a>
<a class="sourceLine" id="cb113-4" title="4">}</a>
<a class="sourceLine" id="cb113-5" title="5"></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="co">##Example</span></a>
<a class="sourceLine" id="cb113-7" title="7"><span class="kw">func</span>(women, mean, <span class="kw">double</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>##   height   weight 
##  65.0000 136.7333</code></pre>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<p>Write an Rcpp function namas MetropolisC, and then use this function to do Exercise 9.4.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb115-2" title="2"><span class="kw">library</span>(Rcpp)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">sourceCpp</span>(<span class="st">&quot;../src/MetropolisC.cpp&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;C:/
## Users/lan/Desktop/StatComp20057/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">N &lt;-<span class="st">  </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb119-2" title="2">sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb119-3" title="3">x0 =<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb119-4" title="4">rw1new =<span class="st"> </span><span class="kw">MetropolisC</span>(sigma[<span class="dv">1</span>],x0,N)</a>
<a class="sourceLine" id="cb119-5" title="5">rw2new =<span class="st"> </span><span class="kw">MetropolisC</span>(sigma[<span class="dv">2</span>],x0,N)</a>
<a class="sourceLine" id="cb119-6" title="6">rw3new =<span class="st"> </span><span class="kw">MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N)</a>
<a class="sourceLine" id="cb119-7" title="7">rw4new =<span class="st"> </span><span class="kw">MetropolisC</span>(sigma[<span class="dv">4</span>],x0,N)</a>
<a class="sourceLine" id="cb119-8" title="8"><span class="co"># number of candidate points rejected</span></a>
<a class="sourceLine" id="cb119-9" title="9">Reject =<span class="st"> </span><span class="kw">cbind</span>(rw1new<span class="op">$</span>k, rw2new<span class="op">$</span>k, rw3new<span class="op">$</span>k, rw4new<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb119-10" title="10"><span class="co">## Accept rates</span></a>
<a class="sourceLine" id="cb119-11" title="11">Accept =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Reject)<span class="op">/</span>N, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb119-12" title="12"><span class="kw">rownames</span>(Accept) =<span class="st"> &quot;Accept rates&quot;</span></a>
<a class="sourceLine" id="cb119-13" title="13"><span class="kw">colnames</span>(Accept) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</a>
<a class="sourceLine" id="cb119-14" title="14">knitr<span class="op">::</span><span class="kw">kable</span>(Accept)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accept rates</td>
<td align="right">0.981</td>
<td align="right">0.8365</td>
<td align="right">0.5005</td>
<td align="right">0.145</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">1.5</span>))  <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb120-3" title="3">    rwnew =<span class="st"> </span><span class="kw">cbind</span>(rw1new<span class="op">$</span>x, rw2new<span class="op">$</span>x, rw3new<span class="op">$</span>x,  rw4new<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb120-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb120-5" title="5">        <span class="kw">plot</span>(rwnew[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb120-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb120-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rwnew[,j]))</a>
<a class="sourceLine" id="cb120-8" title="8">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”</p>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<p>Firstly, the procedure of the R function to implement a random walk Metropolis sampler for generating the standard Laplace distribution is as follows.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb121-2" title="2">laplace_fun &lt;-<span class="st">  </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb121-3" title="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</a>
<a class="sourceLine" id="cb121-4" title="4"> x =<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb121-5" title="5"> x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb121-6" title="6"> u =<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb121-7" title="7"> k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb121-8" title="8"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb121-9" title="9">  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb121-10" title="10">  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace_fun</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">laplace_fun</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </a>
<a class="sourceLine" id="cb121-11" title="11">  <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb121-12" title="12">  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb121-13" title="13">  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb121-14" title="14">  }</a>
<a class="sourceLine" id="cb121-15" title="15"> }</a>
<a class="sourceLine" id="cb121-16" title="16"> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</a>
<a class="sourceLine" id="cb121-17" title="17">}</a>
<a class="sourceLine" id="cb121-18" title="18">N =<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb121-19" title="19">sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb121-20" title="20">x0 =<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb121-21" title="21">rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</a>
<a class="sourceLine" id="cb121-22" title="22">rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</a>
<a class="sourceLine" id="cb121-23" title="23">rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</a>
<a class="sourceLine" id="cb121-24" title="24">rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</a>
<a class="sourceLine" id="cb121-25" title="25"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb121-26" title="26">Reject =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb121-27" title="27">Accept =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Reject)<span class="op">/</span>N,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb121-28" title="28"><span class="kw">rownames</span>(Accept) =<span class="st"> &quot;Accept rates&quot;</span></a>
<a class="sourceLine" id="cb121-29" title="29"><span class="kw">colnames</span>(Accept) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</a>
<a class="sourceLine" id="cb121-30" title="30">knitr<span class="op">::</span><span class="kw">kable</span>(Accept)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accept rates</td>
<td align="right">0.981</td>
<td align="right">0.8365</td>
<td align="right">0.5005</td>
<td align="right">0.145</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">1.5</span>))  <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb122-3" title="3">    rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb122-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb122-5" title="5">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb122-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb122-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb122-8" title="8">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the results of the two functions above, we can see that both of the two functions show that the <span class="math inline">\(3rd\)</span> chains of <span class="math inline">\(\sigma = 2\)</span> have the most efficient rejection rates.</p>
<p>Compare the results from two functions with “qqplot”</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb123-2" title="2">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb123-3" title="3">rwnew &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1new<span class="op">$</span>x, rw2new<span class="op">$</span>x, rw3new<span class="op">$</span>x,  rw4new<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb123-4" title="4">mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N,]</a>
<a class="sourceLine" id="cb123-5" title="5">mcnew &lt;-<span class="st"> </span>rwnew[<span class="dv">501</span><span class="op">:</span>N,]</a>
<a class="sourceLine" id="cb123-6" title="6">q_rw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x,a))</a>
<a class="sourceLine" id="cb123-7" title="7">q_rwnew &lt;-<span class="st"> </span><span class="kw">apply</span>(mcnew, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x,a))</a>
<a class="sourceLine" id="cb123-8" title="8">qtable &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">cbind</span>(q_rw, q_rwnew), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb123-9" title="9"><span class="kw">colnames</span>(qtable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;rw1&quot;</span>,<span class="st">&quot;rw2&quot;</span>,<span class="st">&quot;rw3&quot;</span>,<span class="st">&quot;rw4&quot;</span>,<span class="st">&quot;rw1new&quot;</span>,<span class="st">&quot;rw2new&quot;</span>,<span class="st">&quot;rw3new&quot;</span>,<span class="st">&quot;rw4new&quot;</span>)</a>
<a class="sourceLine" id="cb123-10" title="10">qtable</a></code></pre></div>
<pre><code>##         rw1    rw2    rw3    rw4 rw1new rw2new rw3new rw4new
## 5%   24.112 -1.823 -1.816 -1.989 24.112 -1.823 -1.816 -1.989
## 10%  24.251 -1.287 -1.335 -1.421 24.251 -1.287 -1.335 -1.421
## 20%  24.641 -0.778 -0.769 -1.005 24.641 -0.778 -0.769 -1.005
## 30%  25.069 -0.419 -0.422 -0.604 25.069 -0.419 -0.422 -0.604
## 40%  25.206 -0.213 -0.176 -0.406 25.206 -0.213 -0.176 -0.406
## 50%  25.379  0.021  0.015 -0.185 25.379  0.021  0.015 -0.185
## 60%  25.571  0.231  0.249  0.121 25.571  0.231  0.249  0.121
## 70%  25.786  0.592  0.527  0.406 25.786  0.592  0.527  0.406
## 80%  26.006  1.034  0.966  0.636 26.006  1.034  0.966  0.636
## 90%  26.222  1.655  1.690  0.972 26.222  1.655  1.690  0.972
## 100% 26.916  4.114  4.660  5.169 26.916  4.114  4.660  5.169
## 95%  26.359  2.145  2.380  1.747 26.359  2.145  2.380  1.747</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="co">#qqplot</span></a>
<a class="sourceLine" id="cb125-2" title="2">aa &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb125-3" title="3">QQ_rw3 &lt;-<span class="st"> </span><span class="kw">quantile</span>(rw3<span class="op">$</span>x[<span class="dv">501</span><span class="op">:</span>N], aa)</a>
<a class="sourceLine" id="cb125-4" title="4">QQ_rw3new &lt;-<span class="st"> </span><span class="kw">quantile</span>(rw3new<span class="op">$</span>x[<span class="dv">501</span><span class="op">:</span>N], aa)</a>
<a class="sourceLine" id="cb125-5" title="5"><span class="kw">qqplot</span>(QQ_rw3, QQ_rw3new, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;rw3 quantiles&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;rw3new quantiles&quot;</span>)</a>
<a class="sourceLine" id="cb125-6" title="6"><span class="kw">qqline</span>(QQ_rw3new)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the “qqplot” of two functions result, we can see the most of the quantiles are equal. Therefore the two functions generate random numbers approximately following the same distribution.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<p>The commennts of my results is as follows. We can get that the Rcpp function is much more faster than R function.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">set.seed</span>(<span class="dv">111111</span>)</a>
<a class="sourceLine" id="cb126-2" title="2"><span class="kw">library</span>(microbenchmark)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb128-2" title="2">  <span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N),</a>
<a class="sourceLine" id="cb128-3" title="3">  <span class="kw">MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N))</a>
<a class="sourceLine" id="cb128-4" title="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</a></code></pre></div>
<pre><code>##                             expr      mean
## 1 rw.Metropolis(sigma[3], x0, N) 36834.809
## 2   MetropolisC(sigma[3], x0, N)  1027.305</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">mean_time &lt;-<span class="st"> </span><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)][,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb130-2" title="2">mean_time[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>mean_time[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 35.85577</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;the Rcpp function is&quot;</span>, mean_time[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>mean_time[<span class="dv">2</span>], <span class="st">&quot;times faster than the R function on average.&quot;</span>)</a></code></pre></div>
<pre><code>## the Rcpp function is 35.85577 times faster than the R function on average.</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
